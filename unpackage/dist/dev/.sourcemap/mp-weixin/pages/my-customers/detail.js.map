{"version":3,"file":"detail.js","sources":["pages/my-customers/detail.vue","pages/my-customers/detail.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <view class=\"edit-btn\" @tap=\"goEdit\">ÁºñËæë</view>\n    <scroll-view class=\"content\" scroll-y>\n      <view class=\"hero\">\n        <image class=\"avatar\" :src=\"customer.avatar || defaultAvatar\" mode=\"aspectFill\"></image>\n        <view class=\"info\">\n          <view class=\"name-row\">\n            <text class=\"name\">{{ customer.name }}</text>\n            <text v-if=\"customer.is_vip\" class=\"vip-pill\">VIP</text>\n          </view>\n          <view class=\"tag-row\">\n            <text v-if=\"customer.store_name\" class=\"tag\">{{ customer.store_name }}</text>\n            <text v-if=\"customer.tags\" class=\"tag\">{{ customer.tags }}</text>\n            <text class=\"city\" v-if=\"customer.city\">{{ customer.city }}</text>\n          </view>\n          <view class=\"phone-row\">\n            <text class=\"phone-icon\">üìû</text>\n            <text>{{ customer.phone || '-' }}</text>\n          </view>\n        </view>\n      </view>\n\n      <view class=\"stat-card\">\n        <view class=\"stat\">\n          <text class=\"stat-label\">Á¥ØËÆ°Ê∂àË¥π</text>\n          <text class=\"stat-value\">¬•{{ toAmount(stats.total_spend) }}</text>\n        </view>\n        <view class=\"divider\"></view>\n        <view class=\"stat\">\n          <text class=\"stat-label\">Âà∞Â∫óÊ¨°Êï∞</text>\n          <text class=\"stat-value\">{{ stats.visit_count || 0 }} Ê¨°</text>\n        </view>\n      </view>\n\n      <scroll-view class=\"section-tabs\" scroll-x enable-flex>\n        <view v-for=\"tab in tabs\" :key=\"tab.value\" class=\"section-tab\" :class=\"{ active: activeTab === tab.value }\" @tap=\"activeTab = tab.value\">\n          {{ tab.label }}\n        </view>\n      </scroll-view>\n\n      <view class=\"tab-panel\" v-if=\"activeTab === 'purchase'\">\n        <view v-if=\"purchaseHistory.length\" class=\"record-list\">\n          <view class=\"record-card purchase-card\" v-for=\"item in purchaseHistory\" :key=\"item._id\">\n            <view class=\"purchase-head\">\n              <text class=\"purchase-title\">{{ item.package_name }}</text>\n              <text class=\"purchase-amount\">¬•{{ toAmount(item.amount) }}</text>\n            </view>\n            <view class=\"purchase-sub\">{{ item.purchase_date }} ¬∑ {{ item.service_times }} Ê¨°</view>\n            <view class=\"record-remark\" v-if=\"item.remark\">{{ item.remark }}</view>\n          </view>\n        </view>\n        <view v-else class=\"placeholder-list\"><text class=\"placeholder-title\">ÊöÇÊó†Ë¥≠‰π∞ËÆ∞ÂΩï</text></view>\n      </view>\n\n      <view class=\"tab-panel\" v-else-if=\"activeTab === 'consume'\">\n        <view v-if=\"consumeHistory.length\" class=\"record-list\">\n          <view class=\"record-card consume-card\" v-for=\"item in consumeHistory\" :key=\"item._id || item.id\">\n            <view class=\"consume-row\">\n              <view>\n                <view class=\"consume-title\">{{ item.product_name || item.package_name || 'È°πÁõÆ' }}</view>\n                <view class=\"consume-meta\">{{ formatConsumeDate(item.consumed_at || item.service_date) }} ¬∑ Ê∂àËÄó{{ item.count || item.service_times || 0 }}Ê¨°</view>\n              </view>\n              <text class=\"consume-remaining\">{{ renderRemaining(item._remaining) }}</text>\n            </view>\n            <view class=\"record-remark\" v-if=\"item.note\">{{ item.note }}</view>\n          </view>\n        </view>\n        <view v-else class=\"placeholder-list\"><text class=\"placeholder-title\">ÊöÇÊó†Ê∂àËÄóËÆ∞ÂΩï</text></view>\n      </view>\n      <view class=\"tab-panel\" v-else-if=\"activeTab === 'booking'\">\n        <view class=\"placeholder-list\"><text class=\"placeholder-title\">ÊöÇÊó†È¢ÑÁ∫¶ËÆ∞ÂΩï</text></view>\n      </view>\n      <view class=\"tab-panel\" v-else-if=\"activeTab === 'gallery'\">\n        <view class=\"placeholder-list\"><text class=\"placeholder-line\">ÂõæÂ∫ìÂç†‰Ωç</text></view>\n      </view>\n      <view class=\"tab-panel\" v-else>\n        <text class=\"placeholder-title\">Â§áÊ≥®</text>\n        <textarea class=\"notes\" v-model=\"notesDraft\" placeholder=\"Â°´ÂÜôÂ§áÊ≥®\"></textarea>\n        <button class=\"btn primary\" @tap=\"saveNotes\">‰øùÂ≠òÂ§áÊ≥®</button>\n      </view>\n\n    </scroll-view>\n    <view class=\"cta-bar\">\n      <view class=\"cta-buttons\">\n        <button class=\"btn fab-btn\" @tap=\"goPurchase\">Ôºã Ë¥≠‰π∞</button>\n        <button class=\"btn fab-btn\" @tap=\"goConsume\">Ôºã Ê∂àËÄó</button>\n        <button class=\"btn fab-btn gold\" @tap=\"comingSoon('È¢ÑÁ∫¶')\">Ôºã È¢ÑÁ∫¶</button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\n// @ts-nocheck\nimport { getCustomerById, updateCustomer, deleteCustomer as deleteCustomerApi } from '@/api/customers.js'\nimport { listPurchases } from '@/api/purchases.js'\n\nexport default {\n  data() {\n    return {\n      id: '',\n      customer: {},\n      notesDraft: '',\n      defaultAvatar: 'https://cdn.uviewui.com/uview/album/1.jpg',\n      tabs: [\n        { label: 'Ë¥≠‰π∞', value: 'purchase' },\n        { label: 'Ê∂àËÄó', value: 'consume' },\n        { label: 'È¢ÑÁ∫¶', value: 'booking' },\n        { label: 'ÂõæÂ∫ì', value: 'gallery' },\n        { label: 'Â§áÊ≥®', value: 'notes' }\n      ],\n      activeTab: 'purchase',\n      purchaseHistory: [],\n      consumeHistory: [],\n      stats: { total_spend: 0, visit_count: 0 }\n    }\n  },\n  onLoad(query) {\n    this.id = (query && query.id) || ''\n    if (!this.id) {\n      uni.showToast({ title: 'Áº∫Â∞ëÂÆ¢Êà∑ID', icon: 'none' })\n      setTimeout(() => uni.navigateBack(), 400)\n      return\n    }\n    this.loadData()\n  },\n  onShow() {\n    if (this.id) {\n      this.loadCustomerStats()\n    }\n  },\n  methods: {\n    async loadData() {\n      try {\n        const data = await getCustomerById(this.id)\n        if (!data) {\n          uni.showToast({ title: 'ÂÆ¢Êà∑‰∏çÂ≠òÂú®', icon: 'none' })\n          setTimeout(() => uni.navigateBack(), 400)\n          return\n        }\n        this.customer = data\n        this.notesDraft = data.notes || ''\n        uni.setNavigationBarTitle({ title: data.name || 'ÂÆ¢Êà∑ËØ¶ÊÉÖ' })\n        await Promise.all([\n          this.loadCustomerStats(),\n          this.loadPurchaseHistory(),\n          this.loadConsumeHistory()\n        ])\n      } catch (err) {\n        uni.showToast({ title: err?.errMsg || err?.message || 'Âä†ËΩΩÂ§±Ë¥•', icon: 'none' })\n      }\n    },\n    async loadCustomerStats() {\n      const fallback = { total_spend: 0, visit_count: 0 }\n      try {\n        const obj = uniCloud.importObject('stats-customer', { customUI: true })\n        const cid = this.customer._id || this.customer.id || this.id\n        if (!cid) {\n          this.updateStatsState(fallback)\n          return\n        }\n        const res = await obj.summary({ customer_id: cid })\n        const next = (res && res.code === 0 && res.data)\n          ? {\n              total_spend: Number(res.data.total_spend) || 0,\n              visit_count: Number(res.data.visit_count) || 0\n            }\n          : fallback\n        this.updateStatsState(next)\n      } catch (e) {\n        this.updateStatsState(fallback)\n      }\n    },\n    async loadPurchaseHistory() {\n      try {\n        const list = await listPurchases(this.id)\n        this.purchaseHistory = list\n        this.decorateConsumeRecords()\n      } catch (err) {\n        console.log('load purchase failed', err)\n        this.purchaseHistory = []\n      }\n    },\n    async loadConsumeHistory() {\n      try {\n        const service = uniCloud.importObject('curd-consume', { customUI: true })\n        const res = await service.listByCustomer({ customer_id: this.id })\n        this.consumeHistory = this.normalizeCloudList(res)\n        this.decorateConsumeRecords()\n      } catch (err) {\n        console.log('load consume failed', err)\n        this.consumeHistory = []\n      }\n    },\n    normalizeCloudList(payload) {\n      if (Array.isArray(payload)) return payload\n      if (Array.isArray(payload?.data)) return payload.data\n      if (Array.isArray(payload?.result?.data)) return payload.result.data\n      return []\n    },\n    goEdit() {\n      uni.navigateTo({ url: `/pages/my-customers/edit?id=${this.id}` })\n    },\n    goPurchase() {\n      uni.navigateTo({\n        url: '/pages/purchases/create',\n        events: {\n          purchaseCreated: async () => {\n            await Promise.all([this.loadPurchaseHistory(), this.loadCustomerStats()])\n            uni.showToast({ title: 'Â∑≤ËÆ∞ÂΩïË¥≠‰π∞', icon: 'success' })\n          }\n        },\n        success: res => {\n          res.eventChannel.emit('initCustomerInfo', {\n            customerId: this.id,\n            customerName: this.customer.name\n          })\n        }\n      })\n    },\n    goConsume() {\n      const cid = this.customer._id || this.customer.id || this.id\n      if (!cid) {\n        uni.showToast({ title: 'Áº∫Â∞ëÂÆ¢Êà∑ID', icon: 'none' })\n        return\n      }\n      uni.navigateTo({\n        url: `/pages/purchases/consume?customer_id=${cid}&customer_name=${encodeURIComponent(this.customer.name || '')}`,\n        events: {\n          consumeSaved: async () => {\n            await Promise.all([this.loadConsumeHistory(), this.loadCustomerStats()])\n            uni.showToast({ title: 'Ê∂àËÄóÂ∑≤ËÆ∞ÂΩï', icon: 'success' })\n          }\n        }\n      })\n    },\n    comingSoon(label) {\n      uni.showToast({ title: `${label}ÂäüËÉΩÂºÄÂèë‰∏≠`, icon: 'none' })\n    },\n    async saveNotes() {\n      try {\n        await updateCustomer({ _id: this.id, notes: this.notesDraft })\n        this.customer.notes = this.notesDraft\n        uni.showToast({ title: 'Â§áÊ≥®Â∑≤‰øùÂ≠ò', icon: 'success' })\n      } catch (err) {\n        uni.showToast({ title: err?.errMsg || err?.message || '‰øùÂ≠òÂ§±Ë¥•', icon: 'none' })\n      }\n    },\n    confirmDelete() {\n      uni.showModal({\n        title: 'Âà†Èô§ÂÆ¢Êà∑',\n        content: 'Âà†Èô§Âêé‰∏çÂèØÊÅ¢Â§çÔºåÁ°ÆÂÆöÂà†Èô§Ôºü',\n        confirmText: 'Âà†Èô§',\n        confirmColor: '#dd524d',\n        success: res => {\n          if (res.confirm) {\n            this.deleteCustomer()\n          }\n        }\n      })\n    },\n    async deleteCustomer() {\n      try {\n        await deleteCustomerApi(this.id)\n        uni.showToast({ title: 'Â∑≤Âà†Èô§', icon: 'success' })\n        setTimeout(() => uni.navigateBack(), 400)\n      } catch (err) {\n        uni.showToast({ title: err?.errMsg || err?.message || 'Âà†Èô§Â§±Ë¥•', icon: 'none' })\n      }\n    },\n    toAmount(n) {\n      try {\n        return Number(n || 0).toLocaleString('zh-CN')\n      } catch (e) {\n        return n\n      }\n    },\n    formatConsumeDate(value) {\n      if (!value) return '--'\n      const date = typeof value === 'number' || /^\\d+$/.test(value)\n        ? new Date(Number(value))\n        : new Date(value)\n      if (Number.isNaN(date.getTime())) return '--'\n      const m = `${date.getMonth() + 1}`.padStart(2, '0')\n      const d = `${date.getDate()}`.padStart(2, '0')\n      return `${date.getFullYear()}-${m}-${d}`\n    },\n    decorateConsumeRecords() {\n      if (!this.consumeHistory || !this.consumeHistory.length) return\n      const purchaseMap = {}\n      this.purchaseHistory.forEach(item => {\n        const key = item._id || item.id\n        if (!key) return\n        purchaseMap[key] = {\n          total: Number(item.service_times) || 0,\n          remaining: Number(item.service_times) || 0\n        }\n      })\n      const grouped = {}\n      this.consumeHistory.forEach(record => {\n        const bid = record.buy_id || record.buyId || record.buyID || ''\n        grouped[bid] = grouped[bid] || []\n        grouped[bid].push(record)\n      })\n      Object.keys(grouped).forEach(bid => {\n        const list = grouped[bid]\n        list.sort((a, b) => {\n          const at = Number(a.consumed_at || a.create_time || 0)\n          const bt = Number(b.consumed_at || b.create_time || 0)\n          return at - bt\n        })\n        const totalInfo = purchaseMap[bid]\n        let remain = totalInfo ? totalInfo.total : null\n        list.forEach(item => {\n          if (remain === null || remain === undefined) {\n            item._remaining = null\n            return\n          }\n          const cost = Number(item.count || item.service_times || 0)\n          remain = Math.max(0, remain - cost)\n          item._remaining = remain\n        })\n      })\n      this.consumeHistory = [...this.consumeHistory]\n    },\n    renderRemaining(value) {\n      if (value === null || value === undefined || Number.isNaN(value)) {\n        return 'Ââ©‰Ωô--Ê¨°'\n      }\n      return `Ââ©‰Ωô${value}Ê¨°`\n    },\n    updateStatsState(stats) {\n      const safeStats = stats || { total_spend: 0, visit_count: 0 }\n      this.stats = safeStats\n      if (!this.customer || typeof this.customer !== 'object') {\n        this.customer = {\n          ...(this.customer || {}),\n          total_spend: safeStats.total_spend,\n          visit_count: safeStats.visit_count\n        }\n        return\n      }\n      if (typeof this.$set === 'function') {\n        this.$set(this.customer, 'total_spend', safeStats.total_spend)\n        this.$set(this.customer, 'visit_count', safeStats.visit_count)\n      } else {\n        this.customer = {\n          ...this.customer,\n          total_spend: safeStats.total_spend,\n          visit_count: safeStats.visit_count\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.page { min-height:100vh; background:#f6f7f9; position:relative; }\n.content { height:100vh; padding:16px; padding-bottom:140px; box-sizing:border-box; }\n.hero { display:flex; gap:12px; align-items:center; background:#fff; border-radius:20px; padding:16px; box-shadow:0 10px 24px rgba(0,0,0,.04); }\n.hero .avatar { width:72px; height:72px; border-radius:36px; background:#eee; }\n.info { flex:1; }\n.name-row { display:flex; align-items:center; gap:8px; }\n.name { font-size:20px; font-weight:600; color:#222; }\n.vip-pill { font-size:12px; padding:2px 8px; border-radius:12px; background:#f3e7d3; color:#caa265; }\n.tag-row { margin-top:6px; display:flex; gap:8px; color:#9a9aa0; font-size:12px; }\n.tag-row .tag { background:#f6f6f8; padding:2px 8px; border-radius:10px; }\n.phone-row { margin-top:6px; font-size:14px; color:#555; display:flex; gap:6px; }\n.phone-icon { color:#b7b7bc; }\n\n.stat-card { margin-top:16px; background:#fff; border-radius:20px; padding:16px; display:flex; align-items:center; justify-content:space-between; }\n.stat { flex:1; text-align:center; }\n.stat-label { display:block; color:#9a9aa0; font-size:12px; margin-bottom:6px; }\n.stat-value { font-size:18px; font-weight:700; color:#333; }\n.divider { width:1px; height:36px; background:#f0f0f2; }\n\n.section-tabs { margin-top:18px; white-space:nowrap; }\n.section-tab { display:inline-flex; align-items:center; justify-content:center; height:34px; padding:0 14px; margin-right:10px; border-radius:17px; background:#fff; color:#666; font-size:13px; box-shadow:0 2px 6px rgba(0,0,0,0.04); }\n.section-tab.active { background:#caa265; color:#fff; font-weight:600; }\n\n.tab-panel { margin-top:14px; background:#fff; border-radius:20px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,0.03); }\n.record-list { display:flex; flex-direction:column; gap:10px; }\n.record-card { background:#fdfdfd; border-radius:16px; padding:12px; box-shadow:0 2px 6px rgba(0,0,0,0.03); }\n.purchase-card { padding:14px 16px; }\n.purchase-head { display:flex; justify-content:space-between; align-items:center; }\n.purchase-title { font-size:14px; color:#333; font-weight:600; }\n.purchase-amount { font-size:14px; color:#caa265; }\n.consume-count { font-size:14px; color:#caa265; font-weight:600; }\n.consume-card { padding:14px 16px; border-radius:18px; box-shadow:0 6px 20px rgba(0,0,0,0.04); }\n.consume-row { display:flex; justify-content:space-between; align-items:flex-start; gap:12px; }\n.consume-title { font-size:15px; font-weight:600; color:#333; }\n.consume-meta { margin-top:6px; font-size:12px; color:#999; }\n.consume-remaining { font-size:13px; color:#caa265; white-space:nowrap; }\n.purchase-sub { margin-top:8px; font-size:12px; color:#9a9aa0; }\n.record-remark { margin-top:4px; font-size:12px; color:#9a9aa0; }\n.placeholder-title { font-size:14px; color:#333; font-weight:600; }\n.placeholder-line { display:block; margin-top:4px; color:#9a9aa0; font-size:12px; }\n.notes { width:100%; min-height:100px; margin:12px 0; background:#f6f7f9; border-radius:12px; padding:10px; box-sizing:border-box; }\n\n.btn { height:42px; border-radius:22px; font-size:15px; margin-top:8px; }\n.primary { background:#caa265; color:#fff; }\n.ghost { background:#fff; color:#caa265; border:1px solid #eedfc4; }\n.danger { color:#dd524d; border-color:#f6c8cd; }\n.mt16 { margin-top:16px; }\n.cta-bar { position:fixed; left:0; right:0; bottom:0; padding:12px 16px calc(env(safe-area-inset-bottom) + 12px); background:#f6f7f9; box-shadow:0 -6px 18px rgba(0,0,0,0.08); z-index:10; }\n.cta-buttons { display:flex; justify-content:space-between; gap:12px; }\n.fab-btn { flex:1; background:#fff; border-radius:24px; border:1px solid #eee; color:#333; height:42px; }\n.fab-btn.gold { background:#caa265; color:#fff; border:none; }\n\n.edit-btn { position:fixed; right:16px; top:12px; color:#caa265; padding:6px 12px; background:#fff; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.06); z-index:11; }\n</style>\n","import MiniProgramPage from '/Users/zhouzhongwei/Documents/HBuilderProjects/be-crm-main/pages/my-customers/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getCustomerById","uniCloud","listPurchases","updateCustomer","deleteCustomerApi"],"mappings":"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"}