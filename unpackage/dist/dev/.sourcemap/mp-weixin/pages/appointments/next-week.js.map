{"version":3,"file":"next-week.js","sources":["pages/appointments/next-week.vue","pages/appointments/next-week.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <scroll-view class=\"list\" scroll-y refresher-enabled :refresher-triggered=\"refreshing\" @refresherrefresh=\"onRefresh\">\n      <view v-if=\"loading\" class=\"state\">加载中...</view>\n      <view v-else-if=\"!days.length\" class=\"state\">近 7 天暂无预约</view>\n      <view v-else>\n        <view class=\"day-card\" v-for=\"day in days\" :key=\"day.date\">\n          <view class=\"day-head\">\n            <text class=\"day-title\">{{ formatDisplayDate(day.date) }}</text>\n            <text class=\"day-count\" v-if=\"day.items.length\">{{ day.items.length }} 场</text>\n            <text class=\"day-count muted\" v-else>无预约</text>\n          </view>\n          <view v-if=\"day.items.length\" class=\"booking-list\">\n            <view class=\"booking-item\" v-for=\"item in day.items\" :key=\"item.id\" @tap=\"openCustomer(item)\">\n              <view class=\"time-pill\">{{ item.time }}</view>\n              <view class=\"booking-info\">\n                <text class=\"booking-title\">{{ item.service_name || '未命名服务' }}</text>\n                <text class=\"booking-sub\">{{ item.store_name || '未选择门店' }} · {{ item.customer_name || '' }}</text>\n              </view>\n              <text class=\"arrow\">›</text>\n            </view>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script>\n// @ts-nocheck\nimport { fetchNextWeekBookings } from '@/api/analytics.js'\n\nexport default {\n  data() {\n    return {\n      days: [],\n      loading: true,\n      refreshing: false\n    }\n  },\n  async onShow() {\n    await this.loadData()\n  },\n  methods: {\n    async onRefresh() {\n      if (this.refreshing) return\n      this.refreshing = true\n      await this.loadData()\n      setTimeout(() => {\n        this.refreshing = false\n      }, 200)\n    },\n    async loadData() {\n      try {\n        this.loading = true\n        const list = await fetchNextWeekBookings()\n        this.days = list || []\n      } catch (err) {\n        uni.showToast({ title: err?.message || '加载失败', icon: 'none' })\n      } finally {\n        this.loading = false\n      }\n    },\n    formatDisplayDate(dateStr) {\n      const date = new Date(dateStr.replace(/-/g, '/'))\n      if (Number.isNaN(date.getTime())) return dateStr\n      const today = new Date()\n      today.setHours(0, 0, 0, 0)\n      const diff = Math.round((date.getTime() - today.getTime()) / (24 * 60 * 60 * 1000))\n      const label = diff === 0 ? '今天' : diff === 1 ? '明天' : diff === 2 ? '后天' : ''\n      const m = date.getMonth() + 1\n      const d = date.getDate()\n      return label ? `${m}月${d}日 · ${label}` : `${m}月${d}日`\n    },\n    openCustomer(item) {\n      if (!item?.customer_id) return\n      uni.navigateTo({ url: `/pages/my-customers/detail?id=${item.customer_id}` })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.page { min-height:100vh; background:#f6f7f9; }\n.list { height:100vh; padding:16px; box-sizing:border-box; }\n.state { margin-top:80px; text-align:center; color:#a1a1a6; }\n.day-card { background:#fff; border-radius:22px; padding:16px; margin-bottom:16px; box-shadow:0 8px 24px rgba(0,0,0,0.05); }\n.day-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }\n.day-title { font-size:16px; font-weight:600; color:#1c1c1e; }\n.day-count { font-size:13px; color:#caa265; }\n.day-count.muted { color:#a1a1a6; }\n.booking-list { display:flex; flex-direction:column; gap:12px; }\n.booking-item { display:flex; align-items:center; background:#f8f8fa; border-radius:18px; padding:10px 12px; }\n.time-pill { min-width:54px; padding:6px 0; text-align:center; border-radius:16px; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.05); font-weight:600; color:#111; }\n.booking-info { flex:1; margin-left:12px; }\n.booking-title { display:block; font-size:15px; color:#1c1c1e; font-weight:600; }\n.booking-sub { display:block; font-size:12px; color:#8e8e93; margin-top:2px; }\n.arrow { color:#c7c7cc; font-size:18px; margin-left:6px; }\n</style>\n","import MiniProgramPage from '/Users/zhouzhongwei/Documents/HBuilderProjects/be-crm-main/pages/appointments/next-week.vue'\nwx.createPage(MiniProgramPage)"],"names":["fetchNextWeekBookings","uni"],"mappings":";;;AAgCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM,CAAE;AAAA,MACR,SAAS;AAAA,MACT,YAAY;AAAA,IACd;AAAA,EACD;AAAA,EACD,MAAM,SAAS;AACb,UAAM,KAAK,SAAS;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACP,MAAM,YAAY;AAChB,UAAI,KAAK;AAAY;AACrB,WAAK,aAAa;AAClB,YAAM,KAAK,SAAS;AACpB,iBAAW,MAAM;AACf,aAAK,aAAa;AAAA,MACnB,GAAE,GAAG;AAAA,IACP;AAAA,IACD,MAAM,WAAW;AACf,UAAI;AACF,aAAK,UAAU;AACf,cAAM,OAAO,MAAMA,oCAAsB;AACzC,aAAK,OAAO,QAAQ,CAAC;AAAA,MACrB,SAAO,KAAK;AACZC,4BAAI,UAAU,EAAE,QAAO,2BAAK,YAAW,QAAQ,MAAM,QAAQ;AAAA,MAC/D,UAAU;AACR,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IACD,kBAAkB,SAAS;AACzB,YAAM,OAAO,IAAI,KAAK,QAAQ,QAAQ,MAAM,GAAG,CAAC;AAChD,UAAI,OAAO,MAAM,KAAK,QAAS,CAAA;AAAG,eAAO;AACzC,YAAM,QAAQ,oBAAI,KAAK;AACvB,YAAM,SAAS,GAAG,GAAG,GAAG,CAAC;AACzB,YAAM,OAAO,KAAK,OAAO,KAAK,QAAQ,IAAI,MAAM,QAAS,MAAK,KAAK,KAAK,KAAK,IAAK;AAClF,YAAM,QAAQ,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO;AAC1E,YAAM,IAAI,KAAK,SAAQ,IAAK;AAC5B,YAAM,IAAI,KAAK,QAAQ;AACvB,aAAO,QAAQ,GAAG,CAAC,IAAI,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,IAAI,CAAC;AAAA,IACnD;AAAA,IACD,aAAa,MAAM;AACjB,UAAI,EAAC,6BAAM;AAAa;AACxBA,0BAAI,WAAW,EAAE,KAAK,iCAAiC,KAAK,WAAW,IAAI;AAAA,IAC7E;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9EA,GAAG,WAAW,eAAe;"}