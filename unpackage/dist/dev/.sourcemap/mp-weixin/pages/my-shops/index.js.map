{"version":3,"file":"index.js","sources":["pages/my-shops/index.vue","../../../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXktc2hvcHMvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <!-- È°∂ÈÉ®Ê†áÈ¢ò -->\n    <view class=\"page-header\">\n      <text class=\"title\">Èó®Â∫óÁÆ°ÁêÜ</text>\n    </view>\n\n    <!-- ÊêúÁ¥¢Ê°Ü -->\n    <view class=\"search-bar\">\n      <input\n        class=\"search-input\"\n        type=\"text\"\n        v-model=\"keyword\"\n        placeholder=\"ÊêúÁ¥¢Èó®Â∫óÂêçÁß∞ÊàñÂú∞ÂùÄ\"\n        @input=\"applyFilter\"\n        confirm-type=\"search\"\n      />\n    </view>\n\n    <!-- Tabs -->\n    <view class=\"tabs\">\n      <view\n        v-for=\"t in tabs\"\n        :key=\"t.value\"\n        class=\"tab\"\n        :class=\"{ active: activeTab === t.value }\"\n        @tap=\"switchTab(t.value)\"\n      >\n        {{ t.label }}\n      </view>\n    </view>\n\n    <!-- ÂàóË°® -->\n    <scroll-view class=\"list\" scroll-y @scrolltolower=\"loadMore\">\n      <view\n        v-for=\"item in visibleList\"\n        :key=\"item._id\"\n        class=\"card\"\n        @tap=\"openDetail(item)\"\n      >\n        <image class=\"cover\" :src=\"item.cover_image\" mode=\"aspectFill\" />\n        <view class=\"info\">\n          <view class=\"name-row\">\n            <text class=\"name\">{{ item.store_name }}</text>\n            <text class=\"arrow\">></text>\n          </view>\n          <view class=\"addr-row\">\n            <text class=\"addr\">üìç {{ item.store_address }}</text>\n          </view>\n          <view class=\"stat-row\">\n            <view class=\"stat\">\n              <text class=\"symbol\">Ôø•</text>\n              <text class=\"value\">{{ formatMoney(item.month_revenue) }}</text>\n              <text class=\"label\"> ‰∏äÊúàËê•Êî∂</text>\n            </view>\n            <view class=\"stat\">\n              <text class=\"symbol\">üë•</text>\n              <text class=\"value\">{{ item.customer_count }}</text>\n              <text class=\"label\"> ÂÆ¢Êà∑Êï∞</text>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <view v-if=\"loading\" class=\"loading\">Âä†ËΩΩ‰∏≠...</view>\n      <view v-else-if=\"error\" class=\"empty\">{{ error }}</view>\n      <view v-else-if=\"visibleList.length === 0\" class=\"empty\">ÊöÇÊó†Êï∞ÊçÆ</view>\n    </scroll-view>\n\n    <!-- Âè≥‰∏ãËßíÊñ∞Â¢ûÈó®Â∫óÊÇ¨ÊµÆÊåâÈíÆ -->\n    <view class=\"fab\" @tap=\"goCreate\">Ôºã</view>\n  </view>\n</template>\n\n<!-- ÈáçË¶ÅÔºö‰∏çË¶ÅÁî® <script setup>Ôºå‰∏çÂä† lang=\"ts\" -->\n<script>\n// @ts-nocheck\nexport default {\n  data() {\n    return {\n      tabs: [\n        { label: 'ÂÖ®ÈÉ®Èó®Â∫ó', value: 'all' },\n        { label: 'Ëê•‰∏ö‰∏≠', value: 'active' },\n        { label: 'È´òËê•Êî∂', value: 'high' }\n      ],\n      keyword: '',\n      activeTab: 'all',\n      page: 1,\n      pageSize: 10,\n      list: [],\n      loading: false,\n      error: ''\n    }\n  },\n  created() {\n    this.service = uniCloud.importObject('curd-shops')\n  },\n  onShow() {\n    this.fetchShops()\n  },\n  computed: {\n    filtered() {\n      const kw = (this.keyword || '').trim().toLowerCase()\n      let arr = this.list.slice()\n\n      if (this.activeTab === 'active') {\n        arr = arr.filter(function (s) { return s.status === 'active' })\n      } else if (this.activeTab === 'high') {\n        arr = arr.filter(function (s) { return (s.month_revenue || 0) >= 100000 })\n      }\n\n      if (kw) {\n        arr = arr.filter(function (s) {\n          var name = (s.store_name || '').toLowerCase()\n          var addr = (s.store_address || '').toLowerCase()\n          return name.indexOf(kw) > -1 || addr.indexOf(kw) > -1\n        })\n      }\n      return arr\n    },\n    visibleList() {\n      return this.filtered.slice(0, this.page * this.pageSize)\n    }\n  },\n  methods: {\n    async fetchShops() {\n      this.loading = true\n      this.error = ''\n      try {\n        const data = await this.service.listMyShops()\n        const list = Array.isArray(data) ? data : (data && data.data) || []\n        this.list = list\n        this.page = 1\n      } catch (err) {\n        this.list = []\n        this.error = err?.errMsg || err?.message || 'Âä†ËΩΩÂ§±Ë¥•'\n        uni.showToast({ title: this.error, icon: 'none' })\n      } finally {\n        this.loading = false\n      }\n    },\n    switchTab(v) {\n      this.activeTab = v\n      this.page = 1\n    },\n    applyFilter() {\n      this.page = 1\n    },\n    loadMore() {\n      if (this.visibleList.length < this.filtered.length) {\n        this.page += 1\n      }\n    },\n    openDetail(item) {\n      uni.navigateTo({ url: `/pages/my-shops/detail?id=${item._id}` })\n    },\n    goCreate() {\n      uni.navigateTo({ url: '/pages/my-shops/create' })\n    },\n    formatMoney(n) {\n      if (typeof n !== 'number') return n\n      return n.toLocaleString('zh-CN')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.page { min-height: 100vh; background: #f6f7f9; padding: 16px 16px 0; box-sizing: border-box; }\n.page-header { padding-top: 8px; padding-bottom: 8px; }\n.title { font-size: 20px; font-weight: 600; color: #222; }\n.search-bar { margin: 8px 0; }\n.search-input { width:100%; height:40px; background:#fff; border-radius:12px; padding:0 14px; box-sizing:border-box; font-size:14px; color:#333; box-shadow:0 1px 2px rgba(0,0,0,0.04);}\n.tabs { display:flex; gap:10px; margin:10px 0 12px; }\n.tab { padding: 8px 14px; border-radius: 20px; background:#fff; font-size:14px; color:#6c6c6c; box-shadow:0 1px 2px rgba(0,0,0,0.04); }\n.tab.active { background:#e8d7be; color:#5a3e16; font-weight:600; }\n.list { height: calc(100vh - 160px); }\n.card { display:flex; gap:12px; background:#fff; border-radius:16px; padding:12px; margin-bottom:12px; box-shadow:0 4px 12px rgba(0,0,0,0.04); }\n.cover { width:84px; height:84px; border-radius:12px; background:#f2f2f2; }\n.info { flex:1; min-width:0; }\n.name-row { display:flex; align-items:center; justify-content:space-between; }\n.name { font-size:16px; font-weight:600; color:#222; max-width:80%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }\n.arrow { font-size:18px; line-height:1; color:#b8b8b8; }\n.addr-row { margin-top:4px; }\n.addr { font-size:12px; color:#8a8a8a; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }\n.stat-row { margin-top:8px; display:flex; gap:14px; }\n.stat .symbol { font-size:12px; color:#b08a47; margin-right:2px; }\n.stat .value { font-size:14px; font-weight:600; color:#333; margin-right:4px; }\n.stat .label { font-size:12px; color:#8a8a8a; }\n.loading { text-align:center; color:#777; padding:16px 0; }\n.empty { text-align:center; color:#999; padding:24px 0 64px; }\n\n/* ÊÇ¨ÊµÆÊñ∞Â¢ûÊåâÈíÆ */\n.fab { position: fixed; right: 16px; bottom: 88px; width: 52px; height: 52px; border-radius: 26px; background: #caa265; color: #fff; font-size: 28px; display:flex; align-items:center; justify-content:center; box-shadow: 0 8px 16px rgba(0,0,0,.15); z-index: 10; }\n</style>\n","import MiniProgramPage from 'D:/ÁßªÂä®‰∫ëÁõòÂêåÊ≠•Áõò/hua-Â∫îÁî®/be-crm/be-crm/be-crm/pages/my-shops/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni"],"mappings":";;AA6EA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM;AAAA,QACJ,EAAE,OAAO,QAAQ,OAAO,MAAO;AAAA,QAC/B,EAAE,OAAO,OAAO,OAAO,SAAU;AAAA,QACjC,EAAE,OAAO,OAAO,OAAO,OAAO;AAAA,MAC/B;AAAA,MACD,SAAS;AAAA,MACT,WAAW;AAAA,MACX,MAAM;AAAA,MACN,UAAU;AAAA,MACV,MAAM,CAAE;AAAA,MACR,SAAS;AAAA,MACT,OAAO;AAAA,IACT;AAAA,EACD;AAAA,EACD,UAAU;AACR,SAAK,UAAUA,iBAAS,aAAa,YAAY;AAAA,EAClD;AAAA,EACD,SAAS;AACP,SAAK,WAAW;AAAA,EACjB;AAAA,EACD,UAAU;AAAA,IACR,WAAW;AACT,YAAM,MAAM,KAAK,WAAW,IAAI,KAAM,EAAC,YAAY;AACnD,UAAI,MAAM,KAAK,KAAK,MAAM;AAE1B,UAAI,KAAK,cAAc,UAAU;AAC/B,cAAM,IAAI,OAAO,SAAU,GAAG;AAAE,iBAAO,EAAE,WAAW;AAAA,SAAU;AAAA,MAChE,WAAW,KAAK,cAAc,QAAQ;AACpC,cAAM,IAAI,OAAO,SAAU,GAAG;AAAE,kBAAQ,EAAE,iBAAiB,MAAM;AAAA,SAAQ;AAAA,MAC3E;AAEA,UAAI,IAAI;AACN,cAAM,IAAI,OAAO,SAAU,GAAG;AAC5B,cAAI,QAAQ,EAAE,cAAc,IAAI,YAAY;AAC5C,cAAI,QAAQ,EAAE,iBAAiB,IAAI,YAAY;AAC/C,iBAAO,KAAK,QAAQ,EAAE,IAAI,MAAM,KAAK,QAAQ,EAAE,IAAI;AAAA,SACpD;AAAA,MACH;AACA,aAAO;AAAA,IACR;AAAA,IACD,cAAc;AACZ,aAAO,KAAK,SAAS,MAAM,GAAG,KAAK,OAAO,KAAK,QAAQ;AAAA,IACzD;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,MAAM,aAAa;AACjB,WAAK,UAAU;AACf,WAAK,QAAQ;AACb,UAAI;AACF,cAAM,OAAO,MAAM,KAAK,QAAQ,YAAY;AAC5C,cAAM,OAAO,MAAM,QAAQ,IAAI,IAAI,OAAQ,QAAQ,KAAK,QAAS,CAAC;AAClE,aAAK,OAAO;AACZ,aAAK,OAAO;AAAA,MACZ,SAAO,KAAK;AACZ,aAAK,OAAO,CAAC;AACb,aAAK,SAAQ,2BAAK,YAAU,2BAAK,YAAW;AAC5CC,sBAAG,MAAC,UAAU,EAAE,OAAO,KAAK,OAAO,MAAM,QAAQ;AAAA,MACnD,UAAU;AACR,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IACD,UAAU,GAAG;AACX,WAAK,YAAY;AACjB,WAAK,OAAO;AAAA,IACb;AAAA,IACD,cAAc;AACZ,WAAK,OAAO;AAAA,IACb;AAAA,IACD,WAAW;AACT,UAAI,KAAK,YAAY,SAAS,KAAK,SAAS,QAAQ;AAClD,aAAK,QAAQ;AAAA,MACf;AAAA,IACD;AAAA,IACD,WAAW,MAAM;AACfA,0BAAI,WAAW,EAAE,KAAK,6BAA6B,KAAK,GAAG,IAAI;AAAA,IAChE;AAAA,IACD,WAAW;AACTA,oBAAAA,MAAI,WAAW,EAAE,KAAK,0BAA0B;AAAA,IACjD;AAAA,IACD,YAAY,GAAG;AACb,UAAI,OAAO,MAAM;AAAU,eAAO;AAClC,aAAO,EAAE,eAAe,OAAO;AAAA,IACjC;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKA,GAAG,WAAW,eAAe;"}