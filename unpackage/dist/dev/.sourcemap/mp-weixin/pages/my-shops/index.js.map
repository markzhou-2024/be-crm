{"version":3,"file":"index.js","sources":["pages/my-shops/index.vue","../../../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXktc2hvcHMvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <!-- È°∂ÈÉ®Ê†áÈ¢ò -->\n    <view class=\"page-header\">\n      <text class=\"title\">Èó®Â∫óÁÆ°ÁêÜ</text>\n    </view>\n\n    <!-- ÊêúÁ¥¢Ê°Ü -->\n    <view class=\"search-bar\">\n      <input\n        class=\"search-input\"\n        type=\"text\"\n        v-model=\"keyword\"\n        placeholder=\"ÊêúÁ¥¢Èó®Â∫óÂêçÁß∞ÊàñÂú∞ÂùÄ\"\n        @input=\"applyFilter\"\n        confirm-type=\"search\"\n      />\n    </view>\n\n    <!-- Tabs -->\n    <view class=\"tabs\">\n      <view\n        v-for=\"t in tabs\"\n        :key=\"t.value\"\n        class=\"tab\"\n        :class=\"{ active: activeTab === t.value }\"\n        @tap=\"switchTab(t.value)\"\n      >\n        {{ t.label }}\n      </view>\n    </view>\n\n    <!-- ÂàóË°® -->\n    <scroll-view class=\"list\" scroll-y @scrolltolower=\"loadMore\">\n      <view\n        v-for=\"item in visibleList\"\n        :key=\"item._id\"\n        class=\"card\"\n        @tap=\"openDetail(item)\"\n      >\n        <image class=\"cover\" :src=\"item.cover_image\" mode=\"aspectFill\" />\n        <view class=\"info\">\n          <view class=\"name-row\">\n            <text class=\"name\">{{ item.store_name }}</text>\n            <text class=\"arrow\">></text>\n          </view>\n          <view class=\"addr-row\">\n            <text class=\"addr\">üìç {{ item.store_address }}</text>\n          </view>\n          <view class=\"stat-row\">\n            <view class=\"stat\">\n              <text class=\"symbol\">Ôø•</text>\n              <text class=\"value\">{{ formatMoney(item.month_revenue) }}</text>\n              <text class=\"label\"> ‰∏äÊúàËê•Êî∂</text>\n            </view>\n            <view class=\"stat\">\n              <text class=\"symbol\">üë•</text>\n              <text class=\"value\">{{ item.customer_count }}</text>\n              <text class=\"label\"> ÂÆ¢Êà∑Êï∞</text>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <view v-if=\"loading\" class=\"loading\">Âä†ËΩΩ‰∏≠...</view>\n      <view v-else-if=\"error\" class=\"empty\">{{ error }}</view>\n      <view v-else-if=\"visibleList.length === 0\" class=\"empty\">ÊöÇÊó†Êï∞ÊçÆ</view>\n    </scroll-view>\n\n    <!-- Âè≥‰∏ãËßíÊñ∞Â¢ûÈó®Â∫óÊÇ¨ÊµÆÊåâÈíÆ -->\n    <view class=\"fab\" @tap=\"goCreate\">Ôºã</view>\n  </view>\n</template>\n\n<!-- ÈáçË¶ÅÔºö‰∏çË¶ÅÁî® <script setup>Ôºå‰∏çÂä† lang=\"ts\" -->\n<script>\n// @ts-nocheck\nexport default {\n  data() {\n    return {\n      tabs: [\n        { label: 'ÂÖ®ÈÉ®Èó®Â∫ó', value: 'all' },\n        { label: 'Ëê•‰∏ö‰∏≠', value: 'active' },\n        { label: 'È´òËê•Êî∂', value: 'high' }\n      ],\n      keyword: '',\n      activeTab: 'all',\n      page: 1,\n      pageSize: 10,\n      list: [],\n      loading: false,\n      error: ''\n    }\n  },\n  created() {\n    this.service = uniCloud.importObject('curd-shops')\n  },\n  onShow() {\n    this.fetchShops()\n  },\n  computed: {\n    filtered() {\n      const kw = (this.keyword || '').trim().toLowerCase()\n      let arr = this.list.slice()\n\n      if (this.activeTab === 'active') {\n        arr = arr.filter(function (s) { return s.status === 'active' })\n      } else if (this.activeTab === 'high') {\n        arr = arr.filter(function (s) { return (s.month_revenue || 0) >= 100000 })\n      }\n\n      if (kw) {\n        arr = arr.filter(function (s) {\n          var name = (s.store_name || '').toLowerCase()\n          var addr = (s.store_address || '').toLowerCase()\n          return name.indexOf(kw) > -1 || addr.indexOf(kw) > -1\n        })\n      }\n      return arr\n    },\n    visibleList() {\n      return this.filtered.slice(0, this.page * this.pageSize)\n    }\n  },\n  methods: {\n    async fetchShops() {\n      this.loading = true\n      this.error = ''\n      try {\n        const data = await this.service.listMyShops()\n        const list = Array.isArray(data) ? data : (data && data.data) || []\n        this.list = list\n        this.page = 1\n      } catch (err) {\n        this.list = []\n        this.error = err?.errMsg || err?.message || 'Âä†ËΩΩÂ§±Ë¥•'\n        uni.showToast({ title: this.error, icon: 'none' })\n      } finally {\n        this.loading = false\n      }\n    },\n    switchTab(v) {\n      this.activeTab = v\n      this.page = 1\n    },\n    applyFilter() {\n      this.page = 1\n    },\n    loadMore() {\n      if (this.visibleList.length < this.filtered.length) {\n        this.page += 1\n      }\n    },\n    openDetail(item) {\n      uni.navigateTo({ url: `/pages/my-shops/detail?id=${item._id}` })\n    },\n    goCreate() {\n      uni.navigateTo({ url: '/pages/my-shops/create' })\n    },\n    formatMoney(n) {\n      if (typeof n !== 'number') return n\n      return n.toLocaleString('zh-CN')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.page { min-height: 100vh; background: #f6f7f9; padding: 16px 16px 0; box-sizing: border-box; }\n.page-header { padding-top: 8px; padding-bottom: 8px; }\n.title { font-size: 20px; font-weight: 600; color: #222; }\n.search-bar { margin: 8px 0; }\n.search-input { width:100%; height:40px; background:#fff; border-radius:12px; padding:0 14px; box-sizing:border-box; font-size:14px; color:#333; box-shadow:0 1px 2px rgba(0,0,0,0.04);}\n.tabs { display:flex; gap:10px; margin:10px 0 12px; }\n.tab { padding: 8px 14px; border-radius: 20px; background:#fff; font-size:14px; color:#6c6c6c; box-shadow:0 1px 2px rgba(0,0,0,0.04); }\n.tab.active { background:#e8d7be; color:#5a3e16; font-weight:600; }\n.list { height: calc(100vh - 160px); }\n.card { display:flex; gap:12px; background:#fff; border-radius:16px; padding:12px; margin-bottom:12px; box-shadow:0 4px 12px rgba(0,0,0,0.04); }\n.cover { width:84px; height:84px; border-radius:12px; background:#f2f2f2; }\n.info { flex:1; min-width:0; }\n.name-row { display:flex; align-items:center; justify-content:space-between; }\n.name { font-size:16px; font-weight:600; color:#222; max-width:80%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }\n.arrow { font-size:18px; line-height:1; color:#b8b8b8; }\n.addr-row { margin-top:4px; }\n.addr { font-size:12px; color:#8a8a8a; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }\n.stat-row { margin-top:8px; display:flex; gap:14px; }\n.stat .symbol { font-size:12px; color:#b08a47; margin-right:2px; }\n.stat .value { font-size:14px; font-weight:600; color:#333; margin-right:4px; }\n.stat .label { font-size:12px; color:#8a8a8a; }\n.loading { text-align:center; color:#777; padding:16px 0; }\n.empty { text-align:center; color:#999; padding:24px 0 64px; }\n\n/* ÊÇ¨ÊµÆÊñ∞Â¢ûÊåâÈíÆ */\n.fab { position: fixed; right: 16px; bottom: 88px; width: 52px; height: 52px; border-radius: 26px; background: #caa265; color: #fff; font-size: 28px; display:flex; align-items:center; justify-content:center; box-shadow: 0 8px 16px rgba(0,0,0,.15); z-index: 10; }\n</style>\n","import MiniProgramPage from 'D:/ÁßªÂä®‰∫ëÁõòÂêåÊ≠•Áõò/hua-Â∫îÁî®/be-crm/be-crm/be-crm/pages/my-shops/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["_sfc_main","uniCloud","kw","arr","s","name","addr","data","list","err","uni","v","item","n","MiniProgramPage"],"mappings":"uDA6EKA,EAAU,CACb,MAAO,CACL,MAAO,CACL,KAAM,CACJ,CAAE,MAAO,OAAQ,MAAO,KAAO,EAC/B,CAAE,MAAO,MAAO,MAAO,QAAU,EACjC,CAAE,MAAO,MAAO,MAAO,MAAO,CAC/B,EACD,QAAS,GACT,UAAW,MACX,KAAM,EACN,SAAU,GACV,KAAM,CAAE,EACR,QAAS,GACT,MAAO,EACT,CACD,EACD,SAAU,CACR,KAAK,QAAUC,KAAS,aAAa,YAAY,CAClD,EACD,QAAS,CACP,KAAK,WAAW,CACjB,EACD,SAAU,CACR,UAAW,CACT,MAAMC,GAAM,KAAK,SAAW,IAAI,KAAM,EAAC,YAAY,EACnD,IAAIC,EAAM,KAAK,KAAK,MAAM,EAE1B,OAAI,KAAK,YAAc,SACrBA,EAAMA,EAAI,OAAO,SAAUC,EAAG,CAAE,OAAOA,EAAE,SAAW,SAAU,EACrD,KAAK,YAAc,SAC5BD,EAAMA,EAAI,OAAO,SAAUC,EAAG,CAAE,OAAQA,EAAE,eAAiB,IAAM,IAAQ,GAGvEF,IACFC,EAAMA,EAAI,OAAO,SAAUC,EAAG,CAC5B,IAAIC,GAAQD,EAAE,YAAc,IAAI,YAAY,EACxCE,GAAQF,EAAE,eAAiB,IAAI,YAAY,EAC/C,OAAOC,EAAK,QAAQH,CAAE,EAAI,IAAMI,EAAK,QAAQJ,CAAE,EAAI,GACpD,GAEIC,CACR,EACD,aAAc,CACZ,OAAO,KAAK,SAAS,MAAM,EAAG,KAAK,KAAO,KAAK,QAAQ,CACzD,CACD,EACD,QAAS,CACP,MAAM,YAAa,CACjB,KAAK,QAAU,GACf,KAAK,MAAQ,GACb,GAAI,CACF,MAAMI,EAAO,MAAM,KAAK,QAAQ,YAAY,EACtCC,EAAO,MAAM,QAAQD,CAAI,EAAIA,EAAQA,GAAQA,EAAK,MAAS,CAAC,EAClE,KAAK,KAAOC,EACZ,KAAK,KAAO,CACZ,OAAOC,EAAK,CACZ,KAAK,KAAO,CAAC,EACb,KAAK,OAAQA,GAAA,YAAAA,EAAK,UAAUA,GAAA,YAAAA,EAAK,UAAW,OAC5CC,EAAG,MAAC,UAAU,CAAE,MAAO,KAAK,MAAO,KAAM,OAAQ,CACnD,QAAU,CACR,KAAK,QAAU,EACjB,CACD,EACD,UAAUC,EAAG,CACX,KAAK,UAAYA,EACjB,KAAK,KAAO,CACb,EACD,aAAc,CACZ,KAAK,KAAO,CACb,EACD,UAAW,CACL,KAAK,YAAY,OAAS,KAAK,SAAS,SAC1C,KAAK,MAAQ,EAEhB,EACD,WAAWC,EAAM,CACfF,QAAI,WAAW,CAAE,IAAK,6BAA6BE,EAAK,GAAG,GAAI,CAChE,EACD,UAAW,CACTF,EAAAA,MAAI,WAAW,CAAE,IAAK,yBAA0B,CACjD,EACD,YAAYG,EAAG,CACb,OAAI,OAAOA,GAAM,SAAiBA,EAC3BA,EAAE,eAAe,OAAO,CACjC,CACF,CACF,utBCnKA,GAAG,WAAWC,CAAe"}