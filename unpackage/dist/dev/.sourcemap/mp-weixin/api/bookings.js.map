{"version":3,"file":"bookings.js","sources":["api/bookings.js"],"sourcesContent":["const bookingService = uniCloud.importObject('curd-booking', { customUI: true })\n\nfunction unwrap (res) {\n  if (!res) return res\n  if (typeof res === 'object') {\n    if (res.errCode !== undefined && res.errCode !== 0) {\n      const err = new Error(res.errMsg || '请求失败')\n      err.errCode = res.errCode\n      throw err\n    }\n    if (res.code !== undefined && res.code !== 0) {\n      const err = new Error(res.message || res.msg || '请求失败')\n      err.code = res.code\n      throw err\n    }\n  }\n  if (res && res.data !== undefined) {\n    return res.data\n  }\n  return res\n}\n\nfunction toArray (res) {\n  if (Array.isArray(res)) return res\n  if (Array.isArray(res?.data)) return res.data\n  if (Array.isArray(res?.list)) return res.list\n  if (Array.isArray(res?.result?.data)) return res.result.data\n  return []\n}\n\nexport async function createBooking (payload) {\n  const res = await bookingService.add(payload)\n  return unwrap(res)\n}\n\nexport async function listBookingsByCustomer (params = {}) {\n  const res = await bookingService.listByCustomer(params)\n  return toArray(unwrap(res))\n}\n\nexport async function updateBookingStatus ({ booking_id, status }) {\n  const res = await bookingService.updateStatus({ booking_id, status })\n  return unwrap(res)\n}\n\nexport async function listTodayBookings (filters = {}) {\n  if (typeof bookingService.listToday !== 'function') {\n    return []\n  }\n  const res = await bookingService.listToday(filters)\n  return toArray(unwrap(res))\n}\n"],"names":["uniCloud"],"mappings":";;AAAA,MAAM,iBAAiBA,cAAQ,GAAC,aAAa,gBAAgB,EAAE,UAAU,MAAM;AAE/E,SAAS,OAAQ,KAAK;AACpB,MAAI,CAAC;AAAK,WAAO;AACjB,MAAI,OAAO,QAAQ,UAAU;AAC3B,QAAI,IAAI,YAAY,UAAa,IAAI,YAAY,GAAG;AAClD,YAAM,MAAM,IAAI,MAAM,IAAI,UAAU,MAAM;AAC1C,UAAI,UAAU,IAAI;AAClB,YAAM;AAAA,IACP;AACD,QAAI,IAAI,SAAS,UAAa,IAAI,SAAS,GAAG;AAC5C,YAAM,MAAM,IAAI,MAAM,IAAI,WAAW,IAAI,OAAO,MAAM;AACtD,UAAI,OAAO,IAAI;AACf,YAAM;AAAA,IACP;AAAA,EACF;AACD,MAAI,OAAO,IAAI,SAAS,QAAW;AACjC,WAAO,IAAI;AAAA,EACZ;AACD,SAAO;AACT;AAEA,SAAS,QAAS,KAAK;;AACrB,MAAI,MAAM,QAAQ,GAAG;AAAG,WAAO;AAC/B,MAAI,MAAM,QAAQ,2BAAK,IAAI;AAAG,WAAO,IAAI;AACzC,MAAI,MAAM,QAAQ,2BAAK,IAAI;AAAG,WAAO,IAAI;AACzC,MAAI,MAAM,SAAQ,gCAAK,WAAL,mBAAa,IAAI;AAAG,WAAO,IAAI,OAAO;AACxD,SAAO,CAAE;AACX;AAEO,eAAe,cAAe,SAAS;AAC5C,QAAM,MAAM,MAAM,eAAe,IAAI,OAAO;AAC5C,SAAO,OAAO,GAAG;AACnB;AAEO,eAAe,uBAAwB,SAAS,IAAI;AACzD,QAAM,MAAM,MAAM,eAAe,eAAe,MAAM;AACtD,SAAO,QAAQ,OAAO,GAAG,CAAC;AAC5B;AAEO,eAAe,oBAAqB,EAAE,YAAY,UAAU;AACjE,QAAM,MAAM,MAAM,eAAe,aAAa,EAAE,YAAY,QAAQ;AACpE,SAAO,OAAO,GAAG;AACnB;AAEO,eAAe,kBAAmB,UAAU,IAAI;AACrD,MAAI,OAAO,eAAe,cAAc,YAAY;AAClD,WAAO,CAAE;AAAA,EACV;AACD,QAAM,MAAM,MAAM,eAAe,UAAU,OAAO;AAClD,SAAO,QAAQ,OAAO,GAAG,CAAC;AAC5B;;;;;"}