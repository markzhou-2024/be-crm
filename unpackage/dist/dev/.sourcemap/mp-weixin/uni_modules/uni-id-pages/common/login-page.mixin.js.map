{"version":3,"file":"login-page.mixin.js","sources":["uni_modules/uni-id-pages/common/login-page.mixin.js"],"sourcesContent":["import {\r\n\tmutations\r\n} from '@/uni_modules/uni-id-pages/common/store.js'\r\nimport config from '@/uni_modules/uni-id-pages/config.js'\r\nconst mixin = {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tconfig,\r\n\t\t\tuniIdRedirectUrl: '',\r\n\t\t\tisMounted: false\r\n\t\t}\r\n\t},\r\n\tonUnload() {\r\n\t\t// #ifdef H5\r\n\t\tdocument.onkeydown = false\r\n\t\t// #endif\r\n\t},\r\n\tmounted() {\r\n\t\tthis.isMounted = true\r\n\t},\r\n\tonLoad(e) {\r\n\t\tif (e.is_weixin_redirect) {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\tif (window.location.href.includes('#')) {\r\n\t\t\t\t// 将url通过 ? 分割获取后面的参数字符串 再通过 & 将每一个参数单独分割出来\r\n\t\t\t\tconst paramsArr = window.location.href.split('?')[1].split('&')\r\n\t\t\t\tparamsArr.forEach(item => {\r\n\t\t\t\t\tconst arr = item.split('=')\r\n\t\t\t\t\tif (arr[0] == 'code') {\r\n\t\t\t\t\t\te.code = arr[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tthis.$nextTick(n => {\r\n\t\t\t\t// console.log(this.$refs.uniFabLogin);\r\n\t\t\t\tthis.$refs.uniFabLogin.login({\r\n\t\t\t\t\tcode: e.code\r\n\t\t\t\t}, 'weixin')\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (e.uniIdRedirectUrl) {\r\n\t\t\tthis.uniIdRedirectUrl = decodeURIComponent(e.uniIdRedirectUrl)\r\n\t\t}\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tif (getCurrentPages().length === 1) {\r\n\t\t\tuni.hideHomeButton()\r\n\t\t\tconsole.log('已隐藏：返回首页按钮');\r\n\t\t}\r\n\t\t// #endif\r\n\t},\r\n\tcomputed: {\r\n\t\tneedAgreements() {\r\n\t\t\tif (this.isMounted) {\r\n\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\treturn this.$refs.agreements.needAgreements\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tagree: {\r\n\t\t\tget() {\r\n\t\t\t\tif (this.isMounted) {\r\n\t\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\t\treturn this.$refs.agreements.isAgree\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tset(agree) {\r\n\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\tthis.$refs.agreements.isAgree = agree\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('不存在 隐私政策协议组件');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloginSuccess(e) {\r\n\t\t\tmutations.loginSuccess({\r\n\t\t\t\t...e,\r\n\t\t\t\tuniIdRedirectUrl: this.uniIdRedirectUrl\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default mixin\n"],"names":["mixin","config","uni","item","arr","n","agree","mutations"],"mappings":"4GAIMA,EAAQ,CACb,MAAO,CACN,MAAO,CACT,OAAGC,EAAM,OACN,iBAAkB,GAClB,UAAW,EACX,CACD,EACD,UAAW,CAIV,EACD,SAAU,CACT,KAAK,UAAY,EACjB,EACD,OAAO,EAAG,CACL,EAAE,qBACLC,EAAAA,MAAI,YAAY,CACf,KAAM,EACV,CAAI,EAEG,OAAO,SAAS,KAAK,SAAS,GAAG,GAElB,OAAO,SAAS,KAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EACpD,QAAQC,GAAQ,CACzB,MAAMC,EAAMD,EAAK,MAAM,GAAG,EACtBC,EAAI,CAAC,GAAK,SACb,EAAE,KAAOA,EAAI,CAAC,EAEpB,CAAK,EAEF,KAAK,UAAUC,GAAK,CAEnB,KAAK,MAAM,YAAY,MAAM,CAC5B,KAAM,EAAE,IACR,EAAE,QAAQ,CACf,CAAI,GAGE,EAAE,mBACL,KAAK,iBAAmB,mBAAmB,EAAE,gBAAgB,GAI1D,gBAAe,EAAG,SAAW,IAChCH,EAAAA,MAAI,eAAgB,EACpBA,EAAAA,MAAA,MAAA,MAAA,4DAAY,YAAY,EAGzB,EACD,SAAU,CACT,gBAAiB,CAChB,GAAI,KAAK,UACR,OAAI,KAAK,MAAM,WACP,KAAK,MAAM,WAAW,eAEtB,EAGT,EACD,MAAO,CACN,KAAM,CACL,GAAI,KAAK,UACR,OAAI,KAAK,MAAM,WACP,KAAK,MAAM,WAAW,QAEtB,EAGT,EACD,IAAII,EAAO,CACN,KAAK,MAAM,WACd,KAAK,MAAM,WAAW,QAAUA,EAEhCJ,EAAAA,8EAAY,cAAc,CAE3B,CACD,CACD,EACD,QAAS,CACR,aAAa,EAAG,CACfK,EAAAA,UAAU,aAAa,CACtB,GAAG,EACH,iBAAkB,KAAK,gBAC3B,CAAI,CACD,CACD,CACF"}