{"version":3,"file":"login-page.mixin.js","sources":["uni_modules/uni-id-pages/common/login-page.mixin.js"],"sourcesContent":["import {\n\tmutations\n} from '@/uni_modules/uni-id-pages/common/store.js'\nimport config from '@/uni_modules/uni-id-pages/config.js'\nconst mixin = {\n\tdata() {\n\t\treturn {\n\t\t\tconfig,\n\t\t\tuniIdRedirectUrl: '',\n\t\t\tisMounted: false\n\t\t}\n\t},\n\tonUnload() {\n\t\t// #ifdef H5\n\t\tdocument.onkeydown = false\n\t\t// #endif\n\t},\n\tmounted() {\n\t\tthis.isMounted = true\n\t},\n\tonLoad(e) {\n\t\tif (e.is_weixin_redirect) {\n\t\t\tuni.showLoading({\n\t\t\t\tmask: true\n\t\t\t})\n\n\t\t\tif (window.location.href.includes('#')) {\n\t\t\t\t// 将url通过 ? 分割获取后面的参数字符串 再通过 & 将每一个参数单独分割出来\n\t\t\t\tconst paramsArr = window.location.href.split('?')[1].split('&')\n\t\t\t\tparamsArr.forEach(item => {\n\t\t\t\t\tconst arr = item.split('=')\n\t\t\t\t\tif (arr[0] == 'code') {\n\t\t\t\t\t\te.code = arr[1]\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\tthis.$nextTick(n => {\n\t\t\t\t// console.log(this.$refs.uniFabLogin);\n\t\t\t\tthis.$refs.uniFabLogin.login({\n\t\t\t\t\tcode: e.code\n\t\t\t\t}, 'weixin')\n\t\t\t})\n\t\t}\n\n\t\tif (e.uniIdRedirectUrl) {\n\t\t\tthis.uniIdRedirectUrl = decodeURIComponent(e.uniIdRedirectUrl)\n\t\t}\n\n\t\t// #ifdef MP-WEIXIN\n\t\tif (getCurrentPages().length === 1) {\n\t\t\tuni.hideHomeButton()\n\t\t\tconsole.log('已隐藏：返回首页按钮');\n\t\t}\n\t\t// #endif\n\t},\n\tcomputed: {\n\t\tneedAgreements() {\n\t\t\tif (this.isMounted) {\n\t\t\t\tif (this.$refs.agreements) {\n\t\t\t\t\treturn this.$refs.agreements.needAgreements\n\t\t\t\t} else {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tagree: {\n\t\t\tget() {\n\t\t\t\tif (this.isMounted) {\n\t\t\t\t\tif (this.$refs.agreements) {\n\t\t\t\t\t\treturn this.$refs.agreements.isAgree\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tset(agree) {\n\t\t\t\tif (this.$refs.agreements) {\n\t\t\t\t\tthis.$refs.agreements.isAgree = agree\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('不存在 隐私政策协议组件');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tloginSuccess(e) {\n\t\t\tmutations.loginSuccess({\n\t\t\t\t...e,\n\t\t\t\tuniIdRedirectUrl: this.uniIdRedirectUrl\n\t\t\t})\n\t\t}\n\t}\n}\n\nexport default mixin\n"],"names":["config","uni","mutations"],"mappings":";;;;AAIK,MAAC,QAAQ;AAAA,EACb,OAAO;AACN,WAAO;AAAA,MACT,QAAGA,8BAAM;AAAA,MACN,kBAAkB;AAAA,MAClB,WAAW;AAAA,IACX;AAAA,EACD;AAAA,EACD,WAAW;AAAA,EAIV;AAAA,EACD,UAAU;AACT,SAAK,YAAY;AAAA,EACjB;AAAA,EACD,OAAO,GAAG;AACT,QAAI,EAAE,oBAAoB;AACzBC,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,MACV,CAAI;AAED,UAAI,OAAO,SAAS,KAAK,SAAS,GAAG,GAAG;AAEvC,cAAM,YAAY,OAAO,SAAS,KAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG;AAC9D,kBAAU,QAAQ,UAAQ;AACzB,gBAAM,MAAM,KAAK,MAAM,GAAG;AAC1B,cAAI,IAAI,CAAC,KAAK,QAAQ;AACrB,cAAE,OAAO,IAAI,CAAC;AAAA,UACd;AAAA,QACN,CAAK;AAAA,MACD;AACD,WAAK,UAAU,OAAK;AAEnB,aAAK,MAAM,YAAY,MAAM;AAAA,UAC5B,MAAM,EAAE;AAAA,QACR,GAAE,QAAQ;AAAA,MACf,CAAI;AAAA,IACD;AAED,QAAI,EAAE,kBAAkB;AACvB,WAAK,mBAAmB,mBAAmB,EAAE,gBAAgB;AAAA,IAC7D;AAGD,QAAI,gBAAe,EAAG,WAAW,GAAG;AACnCA,oBAAAA,MAAI,eAAgB;AACpBA,oBAAAA,MAAA,MAAA,OAAA,6DAAY,YAAY;AAAA,IACxB;AAAA,EAED;AAAA,EACD,UAAU;AAAA,IACT,iBAAiB;AAChB,UAAI,KAAK,WAAW;AACnB,YAAI,KAAK,MAAM,YAAY;AAC1B,iBAAO,KAAK,MAAM,WAAW;AAAA,QAClC,OAAW;AACN,iBAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AAAA,IACD,OAAO;AAAA,MACN,MAAM;AACL,YAAI,KAAK,WAAW;AACnB,cAAI,KAAK,MAAM,YAAY;AAC1B,mBAAO,KAAK,MAAM,WAAW;AAAA,UACnC,OAAY;AACN,mBAAO;AAAA,UACP;AAAA,QACD;AAAA,MACD;AAAA,MACD,IAAI,OAAO;AACV,YAAI,KAAK,MAAM,YAAY;AAC1B,eAAK,MAAM,WAAW,UAAU;AAAA,QACrC,OAAW;AACNA,wBAAAA,gFAAY,cAAc;AAAA,QAC1B;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACR,aAAa,GAAG;AACfC,0CAAAA,UAAU,aAAa;AAAA,QACtB,GAAG;AAAA,QACH,kBAAkB,KAAK;AAAA,MAC3B,CAAI;AAAA,IACD;AAAA,EACD;AACF;;"}