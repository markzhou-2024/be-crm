{"version":3,"file":"login-withoutpwd.js","sources":["uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue","uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue?type=page"],"sourcesContent":["<!-- 免密登录页 -->\n<template>\n\t<view class=\"uni-content\">\n\t\t<view class=\"login-logo\">\n\t\t\t<image :src=\"logo\"></image>\n\t\t</view>\n\t\t<!-- 顶部文字 -->\n\t\t<text class=\"title\">请选择登录方式</text>\n\t\t<!-- 快捷登录框 当url带参数时有效 -->\n\t\t<template v-if=\"['apple','weixin', 'weixinMobile'].includes(type)\">\n\t\t\t<text class=\"tip\">将根据第三方账号服务平台的授权范围获取你的信息</text>\n\t\t\t<view class=\"quickLogin\">\n\t\t\t\t<image v-if=\"type !== 'weixinMobile'\" @click=\"quickLogin\" :src=\"imgSrc\" mode=\"widthFix\"\n\t\t\t\t\tclass=\"quickLoginBtn\"></image>\n\t\t\t\t<button v-else type=\"primary\" open-type=\"getPhoneNumber\" @getphonenumber=\"quickLogin\"\n\t\t\t\t\tclass=\"uni-btn\">微信授权手机号登录</button>\n\t\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\n\t\t\t</view>\n\t\t</template>\n\t\t<template v-else>\n\t\t\t<text class=\"tip\">未注册的账号验证通过后将自动注册</text>\n\t\t\t<view class=\"phone-box\">\n\t\t\t\t<view @click=\"chooseArea\" class=\"area\">+86</view>\n\t\t\t\t<uni-easyinput :focus=\"focusPhone\" @blur=\"focusPhone = false\" class=\"input-box\" type=\"number\"\n\t\t\t\t\t:inputBorder=\"false\" v-model=\"phone\" maxlength=\"11\" placeholder=\"请输入手机号\" />\n\t\t\t</view>\n\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\n\t\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"toSmsPage\">获取验证码</button>\n\t\t</template>\n\t\t<!-- 固定定位的快捷登录按钮 -->\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\n\t</view>\n</template>\n\n<script>\n\tlet currentWebview; //当前窗口对象\n\timport config from '@/uni_modules/uni-id-pages/config.js'\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\n\texport default {\n\t\tmixins: [mixin],\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\ttype: \"\", //快捷登录方式\n\t\t\t\tphone: \"\", //手机号码\n\t\t\t\tfocusPhone: false,\n\t\t\t\tlogo: \"/static/logo.png\"\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tasync loginTypes() { //读取配置的登录优先级\n\t\t\t\treturn config.loginTypes\n\t\t\t},\n\t\t\tisPhone() { //手机号码校验正则\n\t\t\t\treturn /^1\\d{10}$/.test(this.phone);\n\t\t\t},\n\t\t\timgSrc() { //大快捷登录按钮图\n\t\t\t\treturn this.type == 'weixin' ? '/uni_modules/uni-id-pages/static/login/weixin.png' :\n\t\t\t\t\t'/uni_modules/uni-id-pages/static/app-plus/apple.png'\n\t\t\t}\n\t\t},\n\t\tasync onLoad(e) {\n\t\t\t//获取通过url传递的参数type设置当前登录方式，如果没传递直接默认以配置的登录\n\t\t\tlet type = e.type || config.loginTypes[0]\n\t\t\tthis.type = type\n\n\t\t\t// console.log(\"this.type: -----------\",this.type);\n\t\t\tif (type != 'univerify') {\n\t\t\t\tthis.focusPhone = true\n\t\t\t}\n\t\t\tthis.$nextTick(() => {\n\t\t\t\t//关闭重复显示的登录快捷方式\n\t\t\t\tif (['weixin', 'apple'].includes(type)) {\n\t\t\t\t\tthis.$refs.uniFabLogin.servicesList = this.$refs.uniFabLogin.servicesList.filter(item =>\n\t\t\t\t\t\titem.id != type)\n\t\t\t\t}\n\t\t\t})\n\t\t\tuni.$on('uni-id-pages-setLoginType', type => {\n\t\t\t\tthis.type = type\n\t\t\t})\n\t\t},\n\t\tonShow() {\n\t\t\t// #ifdef H5\n\t\t\tdocument.onkeydown = event => {\n\t\t\t\tvar e = event || window.event;\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\n\t\t\t\t\tthis.toSmsPage()\n\t\t\t\t}\n\t\t\t};\n\t\t\t// #endif\n\t\t},\n\t\tonUnload() {\n\t\t\tuni.$off('uni-id-pages-setLoginType')\n\t\t},\n\t\tonReady() {\n\t\t\t// 是否优先启动一键登录。即：页面一加载就启动一键登录\n\t\t\t//#ifdef APP-PLUS\n\t\t\tif (this.type == \"univerify\") {\n\t\t\t\tconst pages = getCurrentPages();\n\t\t\t\tcurrentWebview = pages[pages.length - 1].$getAppWebview();\n\t\t\t\tcurrentWebview.setStyle({\n\t\t\t\t\t\"top\": \"2000px\" // 隐藏当前页面窗体\n\t\t\t\t})\n\t\t\t\tthis.type == this.loginTypes[1]\n\t\t\t\t// console.log('开始一键登录');\n\t\t\t\tthis.$refs.uniFabLogin.login_before('univerify')\n\t\t\t}\n\t\t\t//#endif\n\t\t},\n\t\tmethods: {\n\t\t\tshowCurrentWebview(){\n\t\t\t\t// 恢复当前页面窗体的显示 一键登录，默认不显示当前窗口\n\t\t\t\tcurrentWebview.setStyle({\n\t\t\t\t\t\"top\": 0\n\t\t\t\t})\n\t\t\t},\n\t\t\tquickLogin(e) {\n\t\t\t\tlet options = {}\n\n\t\t\t\tif (e.detail?.code) {\n\t\t\t\t\toptions.phoneNumberCode = e.detail.code\n\t\t\t\t}\n\n\t\t\t\tif (this.type === 'weixinMobile' && !e.detail?.code) return\n\n\t\t\t\tthis.$refs.uniFabLogin.login_before(this.type, true, options)\n\t\t\t},\n\t\t\ttoSmsPage() {\n\t\t\t\tif (!this.isPhone) {\n\t\t\t\t\tthis.focusPhone = true\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: \"手机号码格式不正确\",\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (this.needAgreements && !this.agree) {\n\t\t\t\t\treturn this.$refs.agreements.popup(this.toSmsPage)\n\t\t\t\t}\n\t\t\t\t// 发送验证吗\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-smscode?phoneNumber=' + this.phone\n\t\t\t\t});\n\t\t\t},\n\t\t\t//去密码登录页\n\t\t\ttoPwdLogin() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../login/password'\n\t\t\t\t})\n\t\t\t},\n\t\t\tchooseArea() {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '暂不支持其他国家',\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 3000\n\t\t\t\t});\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t@import \"@/uni_modules/uni-id-pages/common/login-page.scss\";\n\n\t@media screen and (min-width: 690px) {\n\t\t.uni-content {\n\t\t\theight: 350px;\n\t\t}\n\t}\n\n\t.uni-content,\n\t.quickLogin {\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t/* #endif */\n\t}\n\n\t.phone-box {\n\t\tposition: relative;\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\t/* #endif */\n\t}\n\n\t.area {\n\t\tposition: absolute;\n\t\tleft: 10px;\n\t\tz-index: 9;\n\t\ttop: 12px;\n\t\tfont-size: 14px;\n\t}\n\n\t.area::after {\n\t\tcontent: \"\";\n\t\tborder: 3px solid transparent;\n\t\tborder-top-color: #000;\n\t\ttop: 12px;\n\t\tleft: 3px;\n\t\tposition: relative;\n\t}\n\n\t/* #ifdef MP */\n\t// 解决小程序端开启虚拟节点virtualHost引起的 class = input-box丢失的问题 [详情参考](https://uniapp.dcloud.net.cn/matter.html#%E5%90%84%E5%AE%B6%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6%E4%B8%8D%E5%90%8C-%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E5%B9%B3%E5%8F%B0%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98)\n\t.phone-box ::v-deep .uni-easyinput__content,\n\t/* #endif */\n\t.input-box {\n\t\t/* #ifndef APP-NVUE */\n\t\tbox-sizing: border-box;\n\t\t/* #endif */\n\t\tflex: 1;\n\t\tpadding-left: 45px;\n\t\tmargin-bottom: 10px;\n\t\tborder-radius: 0;\n\t}\n\n\t.quickLogin {\n\t\theight: 350px;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.quickLoginBtn {\n\t\tmargin: 20px 0;\n\t\twidth: 450rpx;\n\t\t/* #ifndef APP-NVUE */\n\t\tmax-width: 230px;\n\t\t/* #endif */\n\t\theight: 82rpx;\n\t}\n\n\t.tip {\n\t\tmargin-top: -15px;\n\t\tmargin-bottom: 20px;\n\t}\n\n\t@media screen and (min-width: 690px) {\n\t\t.quickLogin {\n\t\t\theight: auto;\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from '/Users/zhouzhongwei/Documents/HBuilderProjects/be-crm-main/uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["mixin","config","uni","type"],"mappings":";;;;AAmCC,IAAI;AAGJ,MAAK,YAAU;AAAA,EACd,QAAQ,CAACA,8CAAAA,KAAK;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA;AAAA,MACN,OAAO;AAAA;AAAA,MACP,YAAY;AAAA,MACZ,MAAM;AAAA,IACP;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,MAAM,aAAa;AAClB,aAAOC,8BAAM,OAAC;AAAA,IACd;AAAA,IACD,UAAU;AACT,aAAO,YAAY,KAAK,KAAK,KAAK;AAAA,IAClC;AAAA,IACD,SAAS;AACR,aAAO,KAAK,QAAQ,WAAW,sDAC9B;AAAA,IACF;AAAA,EACA;AAAA,EACD,MAAM,OAAO,GAAG;AAEf,QAAI,OAAO,EAAE,QAAQA,8BAAAA,OAAO,WAAW,CAAC;AACxC,SAAK,OAAO;AAGZ,QAAI,QAAQ,aAAa;AACxB,WAAK,aAAa;AAAA,IACnB;AACA,SAAK,UAAU,MAAM;AAEpB,UAAI,CAAC,UAAU,OAAO,EAAE,SAAS,IAAI,GAAG;AACvC,aAAK,MAAM,YAAY,eAAe,KAAK,MAAM,YAAY,aAAa,OAAO,UAChF,KAAK,MAAM,IAAI;AAAA,MACjB;AAAA,KACA;AACDC,wBAAI,IAAI,6BAA6B,CAAAC,UAAQ;AAC5C,WAAK,OAAOA;AAAA,KACZ;AAAA,EACD;AAAA,EACD,SAAS;AAAA,EASR;AAAA,EACD,WAAW;AACVD,kBAAG,MAAC,KAAK,2BAA2B;AAAA,EACpC;AAAA,EACD,UAAU;AAAA,EAcT;AAAA,EACD,SAAS;AAAA,IACR,qBAAoB;AAEnB,qBAAe,SAAS;AAAA,QACvB,OAAO;AAAA,OACP;AAAA,IACD;AAAA,IACD,WAAW,GAAG;;AACb,UAAI,UAAU,CAAC;AAEf,WAAI,OAAE,WAAF,mBAAU,MAAM;AACnB,gBAAQ,kBAAkB,EAAE,OAAO;AAAA,MACpC;AAEA,UAAI,KAAK,SAAS,kBAAkB,GAAC,OAAE,WAAF,mBAAU;AAAM;AAErD,WAAK,MAAM,YAAY,aAAa,KAAK,MAAM,MAAM,OAAO;AAAA,IAC5D;AAAA,IACD,YAAY;AACX,UAAI,CAAC,KAAK,SAAS;AAClB,aAAK,aAAa;AAClB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,UAAI,KAAK,kBAAkB,CAAC,KAAK,OAAO;AACvC,eAAO,KAAK,MAAM,WAAW,MAAM,KAAK,SAAS;AAAA,MAClD;AAEAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qEAAqE,KAAK;AAAA,MAChF,CAAC;AAAA,IACD;AAAA;AAAA,IAED,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACD;AAAA,IACD,aAAa;AACZA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,QACN,UAAU;AAAA,MACX,CAAC;AAAA,IACD;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5JD,GAAG,WAAW,eAAe;"}