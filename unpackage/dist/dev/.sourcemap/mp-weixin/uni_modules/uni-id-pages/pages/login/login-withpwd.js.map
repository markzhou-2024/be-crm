{"version":3,"file":"login-withpwd.js","sources":["uni_modules/uni-id-pages/pages/login/login-withpwd.vue","uni_modules/uni-id-pages/pages/login/login-withpwd.vue?type=page"],"sourcesContent":["<!-- 账号密码登录页 -->\n<template>\n\t<view class=\"uni-content\">\n\t\t<view class=\"login-logo\">\n\t\t\t<image :src=\"logo\"></image>\n\t\t</view>\n\t\t<!-- 顶部文字 -->\n\t\t<text class=\"title title-box\">账号密码登录</text>\n\t\t<uni-forms>\n\t\t\t<uni-forms-item name=\"username\">\n\t\t\t\t<uni-easyinput :focus=\"focusUsername\" @blur=\"focusUsername = false\" class=\"input-box\"\n\t\t\t\t\t:inputBorder=\"false\" v-model=\"username\" placeholder=\"请输入手机号/用户名/邮箱\" />\n\t\t\t</uni-forms-item>\n\t\t\t<uni-forms-item name=\"password\">\n\t\t\t\t<uni-easyinput :focus=\"focusPassword\" @blur=\"focusPassword = false\" class=\"input-box\" clearable\n\t\t\t\t\ttype=\"password\" :inputBorder=\"false\" v-model=\"password\" placeholder=\"请输入密码\" />\n\t\t\t</uni-forms-item>\n\t\t</uni-forms>\n\t\t<uni-captcha v-if=\"needCaptcha\" focus ref=\"captcha\" scene=\"login-by-pwd\" v-model=\"captcha\" />\n\t\t<!-- 带选择框的隐私政策协议组件 -->\n\t\t<uni-id-pages-agreements scope=\"login\" ref=\"agreements\"></uni-id-pages-agreements>\n\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"pwdLogin\">登录</button>\n\t\t<!-- 忘记密码 -->\n\t\t<view class=\"link-box\">\n\t\t\t<view v-if=\"!config.isAdmin\">\n\t\t\t\t<text class=\"forget\">忘记了？</text>\n\t\t\t\t<text class=\"link\" @click=\"toRetrievePwd\">找回密码</text>\n\t\t\t</view>\n\t\t\t<text class=\"link\" @click=\"toRegister\">{{config.isAdmin ? '注册管理员账号': '注册账号'}}</text>\n\t\t\t<!-- <text class=\"link\" @click=\"toRegister\" v-if=\"!config.isAdmin\">注册账号</text> -->\n\t\t</view>\n\t\t<!-- 悬浮登录方式组件 -->\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\n\t</view>\n</template>\n\n<script>\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\n\tconst uniIdCo = uniCloud.importObject(\"uni-id-co\", {\n\t\terrorOptions: {\n\t\t\ttype: 'toast'\n\t\t}\n\t})\n\texport default {\n\t\tmixins: [mixin],\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t\"password\": \"\",\n\t\t\t\t\"username\": \"\",\n\t\t\t\t\"captcha\": \"\",\n\t\t\t\t\"needCaptcha\": false,\n\t\t\t\t\"focusUsername\": false,\n\t\t\t\t\"focusPassword\": false,\n\t\t\t\t\"logo\": \"/static/logo.png\"\n\t\t\t}\n\t\t},\n\t\tonShow() {\n\t\t\t// #ifdef H5\n\t\t\tdocument.onkeydown = event => {\n\t\t\t\tvar e = event || window.event;\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\n\t\t\t\t\tthis.pwdLogin()\n\t\t\t\t}\n\t\t\t};\n\t\t\t// #endif\n\t\t},\n\t\tmethods: {\n\t\t\t// 页面跳转，找回密码\n\t\t\ttoRetrievePwd() {\n\t\t\t\tlet url = '/uni_modules/uni-id-pages/pages/retrieve/retrieve'\n\t\t\t\t//如果刚好用户名输入框的值为手机号码，就把它传到retrieve页面，根据该手机号找回密码\n\t\t\t\tif (/^1\\d{10}$/.test(this.username)) {\n\t\t\t\t\turl += `?phoneNumber=${this.username}`\n\t\t\t\t}\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl\n\t\t\t\t})\n\t\t\t},\n\t\t\t/**\n\t\t\t * 密码登录\n\t\t\t */\n\t\t\tpwdLogin() {\n\t\t\t\tif (!this.password.length) {\n\t\t\t\t\tthis.focusPassword = true\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '请输入密码',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (!this.username.length) {\n\t\t\t\t\tthis.focusUsername = true\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '请输入手机号/用户名/邮箱',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (this.needCaptcha && this.captcha.length != 4) {\n\t\t\t\t\tthis.$refs.captcha.getImageCaptcha()\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '请输入验证码',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this.needAgreements && !this.agree) {\n\t\t\t\t\treturn this.$refs.agreements.popup(this.pwdLogin)\n\t\t\t\t}\n\n\t\t\t\tlet data = {\n\t\t\t\t\t\"password\": this.password,\n\t\t\t\t\t\"captcha\": this.captcha\n\t\t\t\t}\n\n\t\t\t\tif (/^1\\d{10}$/.test(this.username)) {\n\t\t\t\t\tdata.mobile = this.username\n\t\t\t\t} else if (/@/.test(this.username)) {\n\t\t\t\t\tdata.email = this.username\n\t\t\t\t} else {\n\t\t\t\t\tdata.username = this.username\n\t\t\t\t}\n\n\t\t\t\tuniIdCo.login(data).then(e => {\n\t\t\t\t\tthis.loginSuccess(e)\n\t\t\t\t}).catch(e => {\n\t\t\t\t\tif (e.errCode == 'uni-id-captcha-required') {\n\t\t\t\t\t\tthis.needCaptcha = true\n\t\t\t\t\t} else if (this.needCaptcha) {\n\t\t\t\t\t\t//登录失败，自动重新获取验证码\n\t\t\t\t\t\tthis.$refs.captcha.getImageCaptcha()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t/* 前往注册 */\n\t\t\ttoRegister() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: this.config.isAdmin ? '/uni_modules/uni-id-pages/pages/register/register-admin' :\n\t\t\t\t\t\t'/uni_modules/uni-id-pages/pages/register/register',\n\t\t\t\t\tfail(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t@import \"@/uni_modules/uni-id-pages/common/login-page.scss\";\n\n\t@media screen and (min-width: 690px) {\n\t\t.uni-content {\n\t\t\theight: auto;\n\t\t}\n\t}\n\n\t.forget {\n\t\tfont-size: 12px;\n\t\tcolor: #8a8f8b;\n\t}\n\n\t.link-box {\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\t/* #endif */\n\t\tflex-direction: row;\n\t\tjustify-content: space-between;\n\t\tmargin-top: 20px;\n\t}\n\n\t.link {\n\t\tfont-size: 12px;\n\t}\n</style>\n","import MiniProgramPage from '/Users/zhouzhongwei/Documents/HBuilderProjects/be-crm-main/uni_modules/uni-id-pages/pages/login/login-withpwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","mixin","uni"],"mappings":";;;AAsCC,MAAM,UAAUA,cAAAA,GAAS,aAAa,aAAa;AAAA,EAClD,cAAc;AAAA,IACb,MAAM;AAAA,EACP;CACA;AACD,MAAK,YAAU;AAAA,EACd,QAAQ,CAACC,8CAAAA,KAAK;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,eAAe;AAAA,MACf,iBAAiB;AAAA,MACjB,iBAAiB;AAAA,MACjB,QAAQ;AAAA,IACT;AAAA,EACA;AAAA,EACD,SAAS;AAAA,EASR;AAAA,EACD,SAAS;AAAA;AAAA,IAER,gBAAgB;AACf,UAAI,MAAM;AAEV,UAAI,YAAY,KAAK,KAAK,QAAQ,GAAG;AACpC,eAAO,gBAAgB,KAAK,QAAQ;AAAA,MACrC;AACAC,oBAAAA,MAAI,WAAW;AAAA,QACd;AAAA,OACA;AAAA,IACD;AAAA;AAAA;AAAA;AAAA,IAID,WAAW;AACV,UAAI,CAAC,KAAK,SAAS,QAAQ;AAC1B,aAAK,gBAAgB;AACrB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,UAAI,CAAC,KAAK,SAAS,QAAQ;AAC1B,aAAK,gBAAgB;AACrB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,UAAI,KAAK,eAAe,KAAK,QAAQ,UAAU,GAAG;AACjD,aAAK,MAAM,QAAQ,gBAAgB;AACnC,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AAEA,UAAI,KAAK,kBAAkB,CAAC,KAAK,OAAO;AACvC,eAAO,KAAK,MAAM,WAAW,MAAM,KAAK,QAAQ;AAAA,MACjD;AAEA,UAAI,OAAO;AAAA,QACV,YAAY,KAAK;AAAA,QACjB,WAAW,KAAK;AAAA,MACjB;AAEA,UAAI,YAAY,KAAK,KAAK,QAAQ,GAAG;AACpC,aAAK,SAAS,KAAK;AAAA,MACpB,WAAW,IAAI,KAAK,KAAK,QAAQ,GAAG;AACnC,aAAK,QAAQ,KAAK;AAAA,aACZ;AACN,aAAK,WAAW,KAAK;AAAA,MACtB;AAEA,cAAQ,MAAM,IAAI,EAAE,KAAK,OAAK;AAC7B,aAAK,aAAa,CAAC;AAAA,OACnB,EAAE,MAAM,OAAK;AACb,YAAI,EAAE,WAAW,2BAA2B;AAC3C,eAAK,cAAc;AAAA,mBACT,KAAK,aAAa;AAE5B,eAAK,MAAM,QAAQ,gBAAgB;AAAA,QACpC;AAAA,OACA;AAAA,IACD;AAAA;AAAA,IAED,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,KAAK,OAAO,UAAU,4DAC1B;AAAA,QACD,KAAK,GAAG;AACPA,wBAAAA,MAAc,MAAA,SAAA,iEAAA,CAAC;AAAA,QAChB;AAAA,OACA;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjJD,GAAG,WAAW,eAAe;"}