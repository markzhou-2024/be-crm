{"version":3,"file":"login-withpwd.js","sources":["uni_modules/uni-id-pages/pages/login/login-withpwd.vue","../../../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXMvdW5pLWlkLXBhZ2VzL3BhZ2VzL2xvZ2luL2xvZ2luLXdpdGhwd2QudnVl"],"sourcesContent":["<!-- 账号密码登录页 -->\r\n<template>\r\n\t<view class=\"uni-content\">\r\n\t\t<view class=\"login-logo\">\r\n\t\t\t<image :src=\"logo\"></image>\r\n\t\t</view>\r\n\t\t<!-- 顶部文字 -->\r\n\t\t<text class=\"title title-box\">账号密码登录</text>\r\n\t\t<uni-forms>\r\n\t\t\t<uni-forms-item name=\"username\">\r\n\t\t\t\t<uni-easyinput :focus=\"focusUsername\" @blur=\"focusUsername = false\" class=\"input-box\"\r\n\t\t\t\t\t:inputBorder=\"false\" v-model=\"username\" placeholder=\"请输入手机号/用户名/邮箱\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"password\">\r\n\t\t\t\t<uni-easyinput :focus=\"focusPassword\" @blur=\"focusPassword = false\" class=\"input-box\" clearable\r\n\t\t\t\t\ttype=\"password\" :inputBorder=\"false\" v-model=\"password\" placeholder=\"请输入密码\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t</uni-forms>\r\n\t\t<uni-captcha v-if=\"needCaptcha\" focus ref=\"captcha\" scene=\"login-by-pwd\" v-model=\"captcha\" />\r\n\t\t<!-- 带选择框的隐私政策协议组件 -->\r\n\t\t<uni-id-pages-agreements scope=\"login\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"pwdLogin\">登录</button>\r\n\t\t<!-- 忘记密码 -->\r\n\t\t<view class=\"link-box\">\r\n\t\t\t<view v-if=\"!config.isAdmin\">\r\n\t\t\t\t<text class=\"forget\">忘记了？</text>\r\n\t\t\t\t<text class=\"link\" @click=\"toRetrievePwd\">找回密码</text>\r\n\t\t\t</view>\r\n\t\t\t<text class=\"link\" @click=\"toRegister\">{{config.isAdmin ? '注册管理员账号': '注册账号'}}</text>\r\n\t\t\t<!-- <text class=\"link\" @click=\"toRegister\" v-if=\"!config.isAdmin\">注册账号</text> -->\r\n\t\t</view>\r\n\t\t<!-- 悬浮登录方式组件 -->\r\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\r\n\tconst uniIdCo = uniCloud.importObject(\"uni-id-co\", {\r\n\t\terrorOptions: {\r\n\t\t\ttype: 'toast'\r\n\t\t}\r\n\t})\r\n\texport default {\r\n\t\tmixins: [mixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t\"password\": \"\",\r\n\t\t\t\t\"username\": \"\",\r\n\t\t\t\t\"captcha\": \"\",\r\n\t\t\t\t\"needCaptcha\": false,\r\n\t\t\t\t\"focusUsername\": false,\r\n\t\t\t\t\"focusPassword\": false,\r\n\t\t\t\t\"logo\": \"/static/logo.png\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// #ifdef H5\r\n\t\t\tdocument.onkeydown = event => {\r\n\t\t\t\tvar e = event || window.event;\r\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\r\n\t\t\t\t\tthis.pwdLogin()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 页面跳转，找回密码\r\n\t\t\ttoRetrievePwd() {\r\n\t\t\t\tlet url = '/uni_modules/uni-id-pages/pages/retrieve/retrieve'\r\n\t\t\t\t//如果刚好用户名输入框的值为手机号码，就把它传到retrieve页面，根据该手机号找回密码\r\n\t\t\t\tif (/^1\\d{10}$/.test(this.username)) {\r\n\t\t\t\t\turl += `?phoneNumber=${this.username}`\r\n\t\t\t\t}\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 密码登录\r\n\t\t\t */\r\n\t\t\tpwdLogin() {\r\n\t\t\t\tif (!this.password.length) {\r\n\t\t\t\t\tthis.focusPassword = true\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入密码',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.username.length) {\r\n\t\t\t\t\tthis.focusUsername = true\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入手机号/用户名/邮箱',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (this.needCaptcha && this.captcha.length != 4) {\r\n\t\t\t\t\tthis.$refs.captcha.getImageCaptcha()\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入验证码',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.needAgreements && !this.agree) {\r\n\t\t\t\t\treturn this.$refs.agreements.popup(this.pwdLogin)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\t\"password\": this.password,\r\n\t\t\t\t\t\"captcha\": this.captcha\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (/^1\\d{10}$/.test(this.username)) {\r\n\t\t\t\t\tdata.mobile = this.username\r\n\t\t\t\t} else if (/@/.test(this.username)) {\r\n\t\t\t\t\tdata.email = this.username\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata.username = this.username\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniIdCo.login(data).then(e => {\r\n\t\t\t\t\tthis.loginSuccess(e)\r\n\t\t\t\t}).catch(e => {\r\n\t\t\t\t\tif (e.errCode == 'uni-id-captcha-required') {\r\n\t\t\t\t\t\tthis.needCaptcha = true\r\n\t\t\t\t\t} else if (this.needCaptcha) {\r\n\t\t\t\t\t\t//登录失败，自动重新获取验证码\r\n\t\t\t\t\t\tthis.$refs.captcha.getImageCaptcha()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/* 前往注册 */\r\n\t\t\ttoRegister() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: this.config.isAdmin ? '/uni_modules/uni-id-pages/pages/register/register-admin' :\r\n\t\t\t\t\t\t'/uni_modules/uni-id-pages/pages/register/register',\r\n\t\t\t\t\tfail(e) {\r\n\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t@import \"@/uni_modules/uni-id-pages/common/login-page.scss\";\r\n\r\n\t@media screen and (min-width: 690px) {\r\n\t\t.uni-content {\r\n\t\t\theight: auto;\r\n\t\t}\r\n\t}\r\n\r\n\t.forget {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #8a8f8b;\r\n\t}\r\n\r\n\t.link-box {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-top: 20px;\r\n\t}\r\n\r\n\t.link {\r\n\t\tfont-size: 12px;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'D:/移动云盘同步盘/hua-应用/be-crm/be-crm/be-crm/uni_modules/uni-id-pages/pages/login/login-withpwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniIdCo","uniCloud","_sfc_main","mixin","url","uni","data","e","MiniProgramPage"],"mappings":"2GAsCOA,EAAUC,EAAAA,GAAS,aAAa,YAAa,CAClD,aAAc,CACb,KAAM,OACP,EACA,EACIC,EAAU,CACd,OAAQ,CAACC,EAAAA,KAAK,EACd,MAAO,CACN,MAAO,CACN,SAAY,GACZ,SAAY,GACZ,QAAW,GACX,YAAe,GACf,cAAiB,GACjB,cAAiB,GACjB,KAAQ,kBACT,CACA,EACD,QAAS,CASR,EACD,QAAS,CAER,eAAgB,CACf,IAAIC,EAAM,oDAEN,YAAY,KAAK,KAAK,QAAQ,IACjCA,GAAO,gBAAgB,KAAK,QAAQ,IAErCC,EAAAA,MAAI,WAAW,CACd,IAAAD,EACA,CACD,EAID,UAAW,CACV,GAAI,CAAC,KAAK,SAAS,OAClB,YAAK,cAAgB,GACdC,EAAAA,MAAI,UAAU,CACpB,MAAO,QACP,KAAM,OACN,SAAU,GACX,CAAC,EAEF,GAAI,CAAC,KAAK,SAAS,OAClB,YAAK,cAAgB,GACdA,EAAAA,MAAI,UAAU,CACpB,MAAO,gBACP,KAAM,OACN,SAAU,GACX,CAAC,EAEF,GAAI,KAAK,aAAe,KAAK,QAAQ,QAAU,EAC9C,YAAK,MAAM,QAAQ,gBAAgB,EAC5BA,EAAAA,MAAI,UAAU,CACpB,MAAO,SACP,KAAM,OACN,SAAU,GACX,CAAC,EAGF,GAAI,KAAK,gBAAkB,CAAC,KAAK,MAChC,OAAO,KAAK,MAAM,WAAW,MAAM,KAAK,QAAQ,EAGjD,IAAIC,EAAO,CACV,SAAY,KAAK,SACjB,QAAW,KAAK,OACjB,EAEI,YAAY,KAAK,KAAK,QAAQ,EACjCA,EAAK,OAAS,KAAK,SACT,IAAI,KAAK,KAAK,QAAQ,EAChCA,EAAK,MAAQ,KAAK,SAElBA,EAAK,SAAW,KAAK,SAGtBN,EAAQ,MAAMM,CAAI,EAAE,KAAKC,GAAK,CAC7B,KAAK,aAAaA,CAAC,EACnB,EAAE,MAAMA,GAAK,CACTA,EAAE,SAAW,0BAChB,KAAK,YAAc,GACT,KAAK,aAEf,KAAK,MAAM,QAAQ,gBAAgB,EAEpC,CACD,EAED,YAAa,CACZF,EAAAA,MAAI,WAAW,CACd,IAAK,KAAK,OAAO,QAAU,0DAC1B,oDACD,KAAKE,EAAG,CACPF,EAAAA,MAAc,MAAA,QAAA,gEAAAE,CAAC,CAChB,EACA,CACF,CACD,CACD,spDCjJD,GAAG,WAAWC,CAAe"}