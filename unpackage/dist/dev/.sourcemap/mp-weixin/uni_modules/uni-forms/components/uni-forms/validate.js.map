{"version":3,"file":"validate.js","sources":["uni_modules/uni-forms/components/uni-forms/validate.js"],"sourcesContent":["var pattern = {\r\n\temail: /^\\S+?@\\S+?\\.\\S+?$/,\r\n\tidcard: /^[1-9]\\d{5}(18|19|([23]\\d))\\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$/,\r\n\turl: new RegExp(\r\n\t\t\"^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\\\S+(?::\\\\S*)?@)?(?:(?:(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}(?:\\\\.(?:[0-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]+-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]+-*)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,})))|localhost)(?::\\\\d{2,5})?(?:(/|\\\\?|#)[^\\\\s]*)?$\",\r\n\t\t'i')\r\n};\r\n\r\nconst FORMAT_MAPPING = {\r\n\t\"int\": 'integer',\r\n\t\"bool\": 'boolean',\r\n\t\"double\": 'number',\r\n\t\"long\": 'number',\r\n\t\"password\": 'string'\r\n\t// \"fileurls\": 'array'\r\n}\r\n\r\nfunction formatMessage(args, resources = '') {\r\n\tvar defaultMessage = ['label']\r\n\tdefaultMessage.forEach((item) => {\r\n\t\tif (args[item] === undefined) {\r\n\t\t\targs[item] = ''\r\n\t\t}\r\n\t})\r\n\r\n\tlet str = resources\r\n\tfor (let key in args) {\r\n\t\tlet reg = new RegExp('{' + key + '}')\r\n\t\tstr = str.replace(reg, args[key])\r\n\t}\r\n\treturn str\r\n}\r\n\r\nfunction isEmptyValue(value, type) {\r\n\tif (value === undefined || value === null) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (typeof value === 'string' && !value) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (Array.isArray(value) && !value.length) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (type === 'object' && !Object.keys(value).length) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nconst types = {\r\n\tinteger(value) {\r\n\t\treturn types.number(value) && parseInt(value, 10) === value;\r\n\t},\r\n\tstring(value) {\r\n\t\treturn typeof value === 'string';\r\n\t},\r\n\tnumber(value) {\r\n\t\tif (isNaN(value)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn typeof value === 'number';\r\n\t},\r\n\t\"boolean\": function(value) {\r\n\t\treturn typeof value === 'boolean';\r\n\t},\r\n\t\"float\": function(value) {\r\n\t\treturn types.number(value) && !types.integer(value);\r\n\t},\r\n\tarray(value) {\r\n\t\treturn Array.isArray(value);\r\n\t},\r\n\tobject(value) {\r\n\t\treturn typeof value === 'object' && !types.array(value);\r\n\t},\r\n\tdate(value) {\r\n\t\treturn value instanceof Date;\r\n\t},\r\n\ttimestamp(value) {\r\n\t\tif (!this.integer(value) || Math.abs(value).toString().length > 16) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\tfile(value) {\r\n\t\treturn typeof value.url === 'string';\r\n\t},\r\n\temail(value) {\r\n\t\treturn typeof value === 'string' && !!value.match(pattern.email) && value.length < 255;\r\n\t},\r\n\turl(value) {\r\n\t\treturn typeof value === 'string' && !!value.match(pattern.url);\r\n\t},\r\n\tpattern(reg, value) {\r\n\t\ttry {\r\n\t\t\treturn new RegExp(reg).test(value);\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\tmethod(value) {\r\n\t\treturn typeof value === 'function';\r\n\t},\r\n\tidcard(value) {\r\n\t\treturn typeof value === 'string' && !!value.match(pattern.idcard);\r\n\t},\r\n\t'url-https'(value) {\r\n\t\treturn this.url(value) && value.startsWith('https://');\r\n\t},\r\n\t'url-scheme'(value) {\r\n\t\treturn value.startsWith('://');\r\n\t},\r\n\t'url-web'(value) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nclass RuleValidator {\r\n\r\n\tconstructor(message) {\r\n\t\tthis._message = message\r\n\t}\r\n\r\n\tasync validateRule(fieldKey, fieldValue, value, data, allData) {\r\n\t\tvar result = null\r\n\r\n\t\tlet rules = fieldValue.rules\r\n\r\n\t\tlet hasRequired = rules.findIndex((item) => {\r\n\t\t\treturn item.required\r\n\t\t})\r\n\t\tif (hasRequired < 0) {\r\n\t\t\tif (value === null || value === undefined) {\r\n\t\t\t\treturn result\r\n\t\t\t}\r\n\t\t\tif (typeof value === 'string' && !value.length) {\r\n\t\t\t\treturn result\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar message = this._message\r\n\r\n\t\tif (rules === undefined) {\r\n\t\t\treturn message['default']\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < rules.length; i++) {\r\n\t\t\tlet rule = rules[i]\r\n\t\t\tlet vt = this._getValidateType(rule)\r\n\r\n\t\t\tObject.assign(rule, {\r\n\t\t\t\tlabel: fieldValue.label || `[\"${fieldKey}\"]`\r\n\t\t\t})\r\n\r\n\t\t\tif (RuleValidatorHelper[vt]) {\r\n\t\t\t\tresult = RuleValidatorHelper[vt](rule, value, message)\r\n\t\t\t\tif (result != null) {\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (rule.validateExpr) {\r\n\t\t\t\tlet now = Date.now()\r\n\t\t\t\tlet resultExpr = rule.validateExpr(value, allData, now)\r\n\t\t\t\tif (resultExpr === false) {\r\n\t\t\t\t\tresult = this._getMessage(rule, rule.errorMessage || this._message['default'])\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (rule.validateFunction) {\r\n\t\t\t\tresult = await this.validateFunction(rule, value, data, allData, vt)\r\n\t\t\t\tif (result !== null) {\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (result !== null) {\r\n\t\t\tresult = message.TAG + result\r\n\t\t}\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\tasync validateFunction(rule, value, data, allData, vt) {\r\n\t\tlet result = null\r\n\t\ttry {\r\n\t\t\tlet callbackMessage = null\r\n\t\t\tconst res = await rule.validateFunction(rule, value, allData || data, (message) => {\r\n\t\t\t\tcallbackMessage = message\r\n\t\t\t})\r\n\t\t\tif (callbackMessage || (typeof res === 'string' && res) || res === false) {\r\n\t\t\t\tresult = this._getMessage(rule, callbackMessage || res, vt)\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tresult = this._getMessage(rule, e.message, vt)\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\t_getMessage(rule, message, vt) {\r\n\t\treturn formatMessage(rule, message || rule.errorMessage || this._message[vt] || message['default'])\r\n\t}\r\n\r\n\t_getValidateType(rule) {\r\n\t\tvar result = ''\r\n\t\tif (rule.required) {\r\n\t\t\tresult = 'required'\r\n\t\t} else if (rule.format) {\r\n\t\t\tresult = 'format'\r\n\t\t} else if (rule.arrayType) {\r\n\t\t\tresult = 'arrayTypeFormat'\r\n\t\t} else if (rule.range) {\r\n\t\t\tresult = 'range'\r\n\t\t} else if (rule.maximum !== undefined || rule.minimum !== undefined) {\r\n\t\t\tresult = 'rangeNumber'\r\n\t\t} else if (rule.maxLength !== undefined || rule.minLength !== undefined) {\r\n\t\t\tresult = 'rangeLength'\r\n\t\t} else if (rule.pattern) {\r\n\t\t\tresult = 'pattern'\r\n\t\t} else if (rule.validateFunction) {\r\n\t\t\tresult = 'validateFunction'\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n}\r\n\r\nconst RuleValidatorHelper = {\r\n\trequired(rule, value, message) {\r\n\t\tif (rule.required && isEmptyValue(value, rule.format || typeof value)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message.required);\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\trange(rule, value, message) {\r\n\t\tconst {\r\n\t\t\trange,\r\n\t\t\terrorMessage\r\n\t\t} = rule;\r\n\r\n\t\tlet list = new Array(range.length);\r\n\t\tfor (let i = 0; i < range.length; i++) {\r\n\t\t\tconst item = range[i];\r\n\t\t\tif (types.object(item) && item.value !== undefined) {\r\n\t\t\t\tlist[i] = item.value;\r\n\t\t\t} else {\r\n\t\t\t\tlist[i] = item;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet result = false\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\tresult = (new Set(value.concat(list)).size === list.length);\r\n\t\t} else {\r\n\t\t\tif (list.indexOf(value) > -1) {\r\n\t\t\t\tresult = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!result) {\r\n\t\t\treturn formatMessage(rule, errorMessage || message['enum']);\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\trangeNumber(rule, value, message) {\r\n\t\tif (!types.number(value)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message.pattern.mismatch);\r\n\t\t}\r\n\r\n\t\tlet {\r\n\t\t\tminimum,\r\n\t\t\tmaximum,\r\n\t\t\texclusiveMinimum,\r\n\t\t\texclusiveMaximum\r\n\t\t} = rule;\r\n\t\tlet min = exclusiveMinimum ? value <= minimum : value < minimum;\r\n\t\tlet max = exclusiveMaximum ? value >= maximum : value > maximum;\r\n\r\n\t\tif (minimum !== undefined && min) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['number'][exclusiveMinimum ?\r\n\t\t\t\t'exclusiveMinimum' : 'minimum'\r\n\t\t\t])\r\n\t\t} else if (maximum !== undefined && max) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['number'][exclusiveMaximum ?\r\n\t\t\t\t'exclusiveMaximum' : 'maximum'\r\n\t\t\t])\r\n\t\t} else if (minimum !== undefined && maximum !== undefined && (min || max)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['number'].range)\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\trangeLength(rule, value, message) {\r\n\t\tif (!types.string(value) && !types.array(value)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message.pattern.mismatch);\r\n\t\t}\r\n\r\n\t\tlet min = rule.minLength;\r\n\t\tlet max = rule.maxLength;\r\n\t\tlet val = value.length;\r\n\r\n\t\tif (min !== undefined && val < min) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['length'].minLength)\r\n\t\t} else if (max !== undefined && val > max) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['length'].maxLength)\r\n\t\t} else if (min !== undefined && max !== undefined && (val < min || val > max)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message['length'].range)\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\tpattern(rule, value, message) {\r\n\t\tif (!types['pattern'](rule.pattern, value)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message.pattern.mismatch);\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\tformat(rule, value, message) {\r\n\t\tvar customTypes = Object.keys(types);\r\n\t\tvar format = FORMAT_MAPPING[rule.format] ? FORMAT_MAPPING[rule.format] : (rule.format || rule.arrayType);\r\n\r\n\t\tif (customTypes.indexOf(format) > -1) {\r\n\t\t\tif (!types[format](value)) {\r\n\t\t\t\treturn formatMessage(rule, rule.errorMessage || message.typeError);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t},\r\n\r\n\tarrayTypeFormat(rule, value, message) {\r\n\t\tif (!Array.isArray(value)) {\r\n\t\t\treturn formatMessage(rule, rule.errorMessage || message.typeError);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < value.length; i++) {\r\n\t\t\tconst element = value[i];\r\n\t\t\tlet formatResult = this.format(rule, element, message)\r\n\t\t\tif (formatResult !== null) {\r\n\t\t\t\treturn formatResult\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t}\r\n}\r\n\r\nclass SchemaValidator extends RuleValidator {\r\n\r\n\tconstructor(schema, options) {\r\n\t\tsuper(SchemaValidator.message);\r\n\r\n\t\tthis._schema = schema\r\n\t\tthis._options = options || null\r\n\t}\r\n\r\n\tupdateSchema(schema) {\r\n\t\tthis._schema = schema\r\n\t}\r\n\r\n\tasync validate(data, allData) {\r\n\t\tlet result = this._checkFieldInSchema(data)\r\n\t\tif (!result) {\r\n\t\t\tresult = await this.invokeValidate(data, false, allData)\r\n\t\t}\r\n\t\treturn result.length ? result[0] : null\r\n\t}\r\n\r\n\tasync validateAll(data, allData) {\r\n\t\tlet result = this._checkFieldInSchema(data)\r\n\t\tif (!result) {\r\n\t\t\tresult = await this.invokeValidate(data, true, allData)\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\tasync validateUpdate(data, allData) {\r\n\t\tlet result = this._checkFieldInSchema(data)\r\n\t\tif (!result) {\r\n\t\t\tresult = await this.invokeValidateUpdate(data, false, allData)\r\n\t\t}\r\n\t\treturn result.length ? result[0] : null\r\n\t}\r\n\r\n\tasync invokeValidate(data, all, allData) {\r\n\t\tlet result = []\r\n\t\tlet schema = this._schema\r\n\t\tfor (let key in schema) {\r\n\t\t\tlet value = schema[key]\r\n\t\t\tlet errorMessage = await this.validateRule(key, value, data[key], data, allData)\r\n\t\t\tif (errorMessage != null) {\r\n\t\t\t\tresult.push({\r\n\t\t\t\t\tkey,\r\n\t\t\t\t\terrorMessage\r\n\t\t\t\t})\r\n\t\t\t\tif (!all) break\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\tasync invokeValidateUpdate(data, all, allData) {\r\n\t\tlet result = []\r\n\t\tfor (let key in data) {\r\n\t\t\tlet errorMessage = await this.validateRule(key, this._schema[key], data[key], data, allData)\r\n\t\t\tif (errorMessage != null) {\r\n\t\t\t\tresult.push({\r\n\t\t\t\t\tkey,\r\n\t\t\t\t\terrorMessage\r\n\t\t\t\t})\r\n\t\t\t\tif (!all) break\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result\r\n\t}\r\n\r\n\t_checkFieldInSchema(data) {\r\n\t\tvar keys = Object.keys(data)\r\n\t\tvar keys2 = Object.keys(this._schema)\r\n\t\tif (new Set(keys.concat(keys2)).size === keys2.length) {\r\n\t\t\treturn ''\r\n\t\t}\r\n\r\n\t\tvar noExistFields = keys.filter((key) => {\r\n\t\t\treturn keys2.indexOf(key) < 0;\r\n\t\t})\r\n\t\tvar errorMessage = formatMessage({\r\n\t\t\tfield: JSON.stringify(noExistFields)\r\n\t\t}, SchemaValidator.message.TAG + SchemaValidator.message['defaultInvalid'])\r\n\t\treturn [{\r\n\t\t\tkey: 'invalid',\r\n\t\t\terrorMessage\r\n\t\t}]\r\n\t}\r\n}\r\n\r\nfunction Message() {\r\n\treturn {\r\n\t\tTAG: \"\",\r\n\t\tdefault: '验证错误',\r\n\t\tdefaultInvalid: '提交的字段{field}在数据库中并不存在',\r\n\t\tvalidateFunction: '验证无效',\r\n\t\trequired: '{label}必填',\r\n\t\t'enum': '{label}超出范围',\r\n\t\ttimestamp: '{label}格式无效',\r\n\t\twhitespace: '{label}不能为空',\r\n\t\ttypeError: '{label}类型无效',\r\n\t\tdate: {\r\n\t\t\tformat: '{label}日期{value}格式无效',\r\n\t\t\tparse: '{label}日期无法解析,{value}无效',\r\n\t\t\tinvalid: '{label}日期{value}无效'\r\n\t\t},\r\n\t\tlength: {\r\n\t\t\tminLength: '{label}长度不能少于{minLength}',\r\n\t\t\tmaxLength: '{label}长度不能超过{maxLength}',\r\n\t\t\trange: '{label}必须介于{minLength}和{maxLength}之间'\r\n\t\t},\r\n\t\tnumber: {\r\n\t\t\tminimum: '{label}不能小于{minimum}',\r\n\t\t\tmaximum: '{label}不能大于{maximum}',\r\n\t\t\texclusiveMinimum: '{label}不能小于等于{minimum}',\r\n\t\t\texclusiveMaximum: '{label}不能大于等于{maximum}',\r\n\t\t\trange: '{label}必须介于{minimum}and{maximum}之间'\r\n\t\t},\r\n\t\tpattern: {\r\n\t\t\tmismatch: '{label}格式不匹配'\r\n\t\t}\r\n\t};\r\n}\r\n\r\n\r\nSchemaValidator.message = new Message();\r\n\r\nexport default SchemaValidator\n"],"names":["pattern","FORMAT_MAPPING","formatMessage","args","resources","defaultMessage","item","str","key","reg","isEmptyValue","value","type","types","RuleValidator","message","fieldKey","fieldValue","data","allData","result","rules","i","rule","vt","RuleValidatorHelper","now","callbackMessage","res","e","range","errorMessage","list","minimum","maximum","exclusiveMinimum","exclusiveMaximum","min","max","val","customTypes","format","element","formatResult","SchemaValidator","schema","options","all","keys","keys2","noExistFields","Message"],"mappings":"aAAA,IAAIA,EAAU,CACb,MAAO,oBACP,OAAQ,+FACR,IAAK,IAAI,OACR,iZACA,GAAG,CACL,EAEA,MAAMC,EAAiB,CACtB,IAAO,UACP,KAAQ,UACR,OAAU,SACV,KAAQ,SACR,SAAY,QAEb,EAEA,SAASC,EAAcC,EAAMC,EAAY,GAAI,CAC5C,IAAIC,EAAiB,CAAC,OAAO,EAC7BA,EAAe,QAASC,GAAS,CAC5BH,EAAKG,CAAI,IAAM,SAClBH,EAAKG,CAAI,EAAI,GAEhB,CAAE,EAED,IAAIC,EAAMH,EACV,QAASI,KAAOL,EAAM,CACrB,IAAIM,EAAM,IAAI,OAAO,IAAMD,EAAM,GAAG,EACpCD,EAAMA,EAAI,QAAQE,EAAKN,EAAKK,CAAG,CAAC,CAChC,CACD,OAAOD,CACR,CAEA,SAASG,EAAaC,EAAOC,EAAM,CAalC,MAZI,GAAuBD,GAAU,MAIjC,OAAOA,GAAU,UAAY,CAACA,GAI9B,MAAM,QAAQA,CAAK,GAAK,CAACA,EAAM,QAI/BC,IAAS,UAAY,CAAC,OAAO,KAAKD,CAAK,EAAE,OAK9C,CAEA,MAAME,EAAQ,CACb,QAAQF,EAAO,CACd,OAAOE,EAAM,OAAOF,CAAK,GAAK,SAASA,EAAO,EAAE,IAAMA,CACtD,EACD,OAAOA,EAAO,CACb,OAAO,OAAOA,GAAU,QACxB,EACD,OAAOA,EAAO,CACb,OAAI,MAAMA,CAAK,EACP,GAED,OAAOA,GAAU,QACxB,EACD,QAAW,SAASA,EAAO,CAC1B,OAAO,OAAOA,GAAU,SACxB,EACD,MAAS,SAASA,EAAO,CACxB,OAAOE,EAAM,OAAOF,CAAK,GAAK,CAACE,EAAM,QAAQF,CAAK,CAClD,EACD,MAAMA,EAAO,CACZ,OAAO,MAAM,QAAQA,CAAK,CAC1B,EACD,OAAOA,EAAO,CACb,OAAO,OAAOA,GAAU,UAAY,CAACE,EAAM,MAAMF,CAAK,CACtD,EACD,KAAKA,EAAO,CACX,OAAOA,aAAiB,IACxB,EACD,UAAUA,EAAO,CAChB,MAAI,GAAC,KAAK,QAAQA,CAAK,GAAK,KAAK,IAAIA,CAAK,EAAE,WAAW,OAAS,GAIhE,EACD,KAAKA,EAAO,CACX,OAAO,OAAOA,EAAM,KAAQ,QAC5B,EACD,MAAMA,EAAO,CACZ,OAAO,OAAOA,GAAU,UAAY,CAAC,CAACA,EAAM,MAAMX,EAAQ,KAAK,GAAKW,EAAM,OAAS,GACnF,EACD,IAAIA,EAAO,CACV,OAAO,OAAOA,GAAU,UAAY,CAAC,CAACA,EAAM,MAAMX,EAAQ,GAAG,CAC7D,EACD,QAAQS,EAAKE,EAAO,CACnB,GAAI,CACH,OAAO,IAAI,OAAOF,CAAG,EAAE,KAAKE,CAAK,CACjC,MAAW,CACX,MAAO,EACP,CACD,EACD,OAAOA,EAAO,CACb,OAAO,OAAOA,GAAU,UACxB,EACD,OAAOA,EAAO,CACb,OAAO,OAAOA,GAAU,UAAY,CAAC,CAACA,EAAM,MAAMX,EAAQ,MAAM,CAChE,EACD,YAAYW,EAAO,CAClB,OAAO,KAAK,IAAIA,CAAK,GAAKA,EAAM,WAAW,UAAU,CACrD,EACD,aAAaA,EAAO,CACnB,OAAOA,EAAM,WAAW,KAAK,CAC7B,EACD,UAAUA,EAAO,CAChB,MAAO,EACP,CACF,EAEA,MAAMG,CAAc,CAEnB,YAAYC,EAAS,CACpB,KAAK,SAAWA,CAChB,CAED,MAAM,aAAaC,EAAUC,EAAYN,EAAOO,EAAMC,EAAS,CAC9D,IAAIC,EAAS,KAEb,IAAIC,EAAQJ,EAAW,MAKvB,GAHkBI,EAAM,UAAWf,GAC3BA,EAAK,QACZ,EACiB,IACbK,GAAU,MAGV,OAAOA,GAAU,UAAY,CAACA,EAAM,QACvC,OAAOS,EAIT,IAAIL,EAAU,KAAK,SAEnB,GAAIM,IAAU,OACb,OAAON,EAAQ,QAGhB,QAASO,EAAI,EAAGA,EAAID,EAAM,OAAQC,IAAK,CACtC,IAAIC,EAAOF,EAAMC,CAAC,EACdE,EAAK,KAAK,iBAAiBD,CAAI,EAMnC,GAJA,OAAO,OAAOA,EAAM,CACnB,MAAON,EAAW,OAAS,KAAKD,CAAQ,IAC5C,CAAI,EAEGS,EAAoBD,CAAE,IACzBJ,EAASK,EAAoBD,CAAE,EAAED,EAAMZ,EAAOI,CAAO,EACjDK,GAAU,MACb,MAIF,GAAIG,EAAK,aAAc,CACtB,IAAIG,EAAM,KAAK,IAAK,EAEpB,GADiBH,EAAK,aAAaZ,EAAOQ,EAASO,CAAG,IACnC,GAAO,CACzBN,EAAS,KAAK,YAAYG,EAAMA,EAAK,cAAgB,KAAK,SAAS,OAAU,EAC7E,KACA,CACD,CAED,GAAIA,EAAK,mBACRH,EAAS,MAAM,KAAK,iBAAiBG,EAAMZ,EAAOO,EAAMC,EAASK,CAAE,EAC/DJ,IAAW,MACd,KAGF,CAED,OAAIA,IAAW,OACdA,EAASL,EAAQ,IAAMK,GAGjBA,CACP,CAED,MAAM,iBAAiBG,EAAMZ,EAAOO,EAAMC,EAASK,EAAI,CACtD,IAAIJ,EAAS,KACb,GAAI,CACH,IAAIO,EAAkB,KACtB,MAAMC,EAAM,MAAML,EAAK,iBAAiBA,EAAMZ,EAAOQ,GAAWD,EAAOH,GAAY,CAClFY,EAAkBZ,CACtB,CAAI,GACGY,GAAoB,OAAOC,GAAQ,UAAYA,GAAQA,IAAQ,MAClER,EAAS,KAAK,YAAYG,EAAMI,GAAmBC,EAAKJ,CAAE,EAE3D,OAAQK,EAAG,CACXT,EAAS,KAAK,YAAYG,EAAMM,EAAE,QAASL,CAAE,CAC7C,CACD,OAAOJ,CACP,CAED,YAAYG,EAAMR,EAASS,EAAI,CAC9B,OAAOtB,EAAcqB,EAAMR,GAAWQ,EAAK,cAAgB,KAAK,SAASC,CAAE,GAAKT,EAAQ,OAAU,CAClG,CAED,iBAAiBQ,EAAM,CACtB,IAAIH,EAAS,GACb,OAAIG,EAAK,SACRH,EAAS,WACCG,EAAK,OACfH,EAAS,SACCG,EAAK,UACfH,EAAS,kBACCG,EAAK,MACfH,EAAS,QACCG,EAAK,UAAY,QAAaA,EAAK,UAAY,OACzDH,EAAS,cACCG,EAAK,YAAc,QAAaA,EAAK,YAAc,OAC7DH,EAAS,cACCG,EAAK,QACfH,EAAS,UACCG,EAAK,mBACfH,EAAS,oBAEHA,CACP,CACF,CAEA,MAAMK,EAAsB,CAC3B,SAASF,EAAMZ,EAAOI,EAAS,CAC9B,OAAIQ,EAAK,UAAYb,EAAaC,EAAOY,EAAK,QAAU,OAAOZ,CAAK,EAC5DT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,QAAQ,EAG1D,IACP,EAED,MAAMQ,EAAMZ,EAAOI,EAAS,CAC3B,KAAM,CACL,MAAAe,EACA,aAAAC,CACA,EAAGR,EAEJ,IAAIS,EAAO,IAAI,MAAMF,EAAM,MAAM,EACjC,QAASR,EAAI,EAAGA,EAAIQ,EAAM,OAAQR,IAAK,CACtC,MAAMhB,EAAOwB,EAAMR,CAAC,EAChBT,EAAM,OAAOP,CAAI,GAAKA,EAAK,QAAU,OACxC0B,EAAKV,CAAC,EAAIhB,EAAK,MAEf0B,EAAKV,CAAC,EAAIhB,CAEX,CAED,IAAIc,EAAS,GASb,OARI,MAAM,QAAQT,CAAK,EACtBS,EAAU,IAAI,IAAIT,EAAM,OAAOqB,CAAI,CAAC,EAAE,OAASA,EAAK,OAEhDA,EAAK,QAAQrB,CAAK,EAAI,KACzBS,EAAS,IAINA,EAIE,KAHClB,EAAcqB,EAAMQ,GAAgBhB,EAAQ,IAAO,CAI3D,EAED,YAAYQ,EAAMZ,EAAOI,EAAS,CACjC,GAAI,CAACF,EAAM,OAAOF,CAAK,EACtB,OAAOT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,QAAQ,QAAQ,EAGzE,GAAI,CACH,QAAAkB,EACA,QAAAC,EACA,iBAAAC,EACA,iBAAAC,CACA,EAAGb,EACAc,EAAMF,EAAmBxB,GAASsB,EAAUtB,EAAQsB,EACpDK,EAAMF,EAAmBzB,GAASuB,EAAUvB,EAAQuB,EAExD,OAAID,IAAY,QAAaI,EACrBnC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAUoB,EACjE,mBAAqB,SACzB,CAAI,EACSD,IAAY,QAAaI,EAC5BpC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAUqB,EACjE,mBAAqB,SACzB,CAAI,EACSH,IAAY,QAAaC,IAAY,SAAcG,GAAOC,GAC7DpC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAU,KAAK,EAGjE,IACP,EAED,YAAYQ,EAAMZ,EAAOI,EAAS,CACjC,GAAI,CAACF,EAAM,OAAOF,CAAK,GAAK,CAACE,EAAM,MAAMF,CAAK,EAC7C,OAAOT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,QAAQ,QAAQ,EAGzE,IAAIsB,EAAMd,EAAK,UACXe,EAAMf,EAAK,UACXgB,EAAM5B,EAAM,OAEhB,OAAI0B,IAAQ,QAAaE,EAAMF,EACvBnC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAU,SAAS,EACjEuB,IAAQ,QAAaC,EAAMD,EAC9BpC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAU,SAAS,EACjEsB,IAAQ,QAAaC,IAAQ,SAAcC,EAAMF,GAAOE,EAAMD,GACjEpC,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,OAAU,KAAK,EAGjE,IACP,EAED,QAAQQ,EAAMZ,EAAOI,EAAS,CAC7B,OAAKF,EAAM,QAAWU,EAAK,QAASZ,CAAK,EAIlC,KAHCT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,QAAQ,QAAQ,CAIzE,EAED,OAAOQ,EAAMZ,EAAOI,EAAS,CAC5B,IAAIyB,EAAc,OAAO,KAAK3B,CAAK,EAC/B4B,EAASxC,EAAesB,EAAK,MAAM,EAAItB,EAAesB,EAAK,MAAM,EAAKA,EAAK,QAAUA,EAAK,UAE9F,OAAIiB,EAAY,QAAQC,CAAM,EAAI,IAC7B,CAAC5B,EAAM4B,CAAM,EAAE9B,CAAK,EAChBT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,SAAS,EAI5D,IACP,EAED,gBAAgBQ,EAAMZ,EAAOI,EAAS,CACrC,GAAI,CAAC,MAAM,QAAQJ,CAAK,EACvB,OAAOT,EAAcqB,EAAMA,EAAK,cAAgBR,EAAQ,SAAS,EAGlE,QAASO,EAAI,EAAGA,EAAIX,EAAM,OAAQW,IAAK,CACtC,MAAMoB,EAAU/B,EAAMW,CAAC,EACvB,IAAIqB,EAAe,KAAK,OAAOpB,EAAMmB,EAAS3B,CAAO,EACrD,GAAI4B,IAAiB,KACpB,OAAOA,CAER,CAED,OAAO,IACP,CACF,EAEA,MAAMC,UAAwB9B,CAAc,CAE3C,YAAY+B,EAAQC,EAAS,CAC5B,MAAMF,EAAgB,OAAO,EAE7B,KAAK,QAAUC,EACf,KAAK,SAAWC,GAAW,IAC3B,CAED,aAAaD,EAAQ,CACpB,KAAK,QAAUA,CACf,CAED,MAAM,SAAS3B,EAAMC,EAAS,CAC7B,IAAIC,EAAS,KAAK,oBAAoBF,CAAI,EAC1C,OAAKE,IACJA,EAAS,MAAM,KAAK,eAAeF,EAAM,GAAOC,CAAO,GAEjDC,EAAO,OAASA,EAAO,CAAC,EAAI,IACnC,CAED,MAAM,YAAYF,EAAMC,EAAS,CAChC,IAAIC,EAAS,KAAK,oBAAoBF,CAAI,EAC1C,OAAKE,IACJA,EAAS,MAAM,KAAK,eAAeF,EAAM,GAAMC,CAAO,GAEhDC,CACP,CAED,MAAM,eAAeF,EAAMC,EAAS,CACnC,IAAIC,EAAS,KAAK,oBAAoBF,CAAI,EAC1C,OAAKE,IACJA,EAAS,MAAM,KAAK,qBAAqBF,EAAM,GAAOC,CAAO,GAEvDC,EAAO,OAASA,EAAO,CAAC,EAAI,IACnC,CAED,MAAM,eAAeF,EAAM6B,EAAK5B,EAAS,CACxC,IAAIC,EAAS,CAAE,EACXyB,EAAS,KAAK,QAClB,QAASrC,KAAOqC,EAAQ,CACvB,IAAIlC,EAAQkC,EAAOrC,CAAG,EAClBuB,EAAe,MAAM,KAAK,aAAavB,EAAKG,EAAOO,EAAKV,CAAG,EAAGU,EAAMC,CAAO,EAC/E,GAAIY,GAAgB,OACnBX,EAAO,KAAK,CACX,IAAAZ,EACA,aAAAuB,CACL,CAAK,EACG,CAACgB,GAAK,KAEX,CACD,OAAO3B,CACP,CAED,MAAM,qBAAqBF,EAAM6B,EAAK5B,EAAS,CAC9C,IAAIC,EAAS,CAAE,EACf,QAASZ,KAAOU,EAAM,CACrB,IAAIa,EAAe,MAAM,KAAK,aAAavB,EAAK,KAAK,QAAQA,CAAG,EAAGU,EAAKV,CAAG,EAAGU,EAAMC,CAAO,EAC3F,GAAIY,GAAgB,OACnBX,EAAO,KAAK,CACX,IAAAZ,EACA,aAAAuB,CACL,CAAK,EACG,CAACgB,GAAK,KAEX,CACD,OAAO3B,CACP,CAED,oBAAoBF,EAAM,CACzB,IAAI8B,EAAO,OAAO,KAAK9B,CAAI,EACvB+B,EAAQ,OAAO,KAAK,KAAK,OAAO,EACpC,GAAI,IAAI,IAAID,EAAK,OAAOC,CAAK,CAAC,EAAE,OAASA,EAAM,OAC9C,MAAO,GAGR,IAAIC,EAAgBF,EAAK,OAAQxC,GACzByC,EAAM,QAAQzC,CAAG,EAAI,CAC5B,EACGuB,EAAe7B,EAAc,CAChC,MAAO,KAAK,UAAUgD,CAAa,CACtC,EAAKN,EAAgB,QAAQ,IAAMA,EAAgB,QAAQ,cAAiB,EAC1E,MAAO,CAAC,CACP,IAAK,UACL,aAAAb,CACH,CAAG,CACD,CACF,CAEA,SAASoB,GAAU,CAClB,MAAO,CACN,IAAK,GACL,QAAS,OACT,eAAgB,wBAChB,iBAAkB,OAClB,SAAU,YACV,KAAQ,cACR,UAAW,cACX,WAAY,cACZ,UAAW,cACX,KAAM,CACL,OAAQ,uBACR,MAAO,0BACP,QAAS,oBACT,EACD,OAAQ,CACP,UAAW,2BACX,UAAW,2BACX,MAAO,sCACP,EACD,OAAQ,CACP,QAAS,uBACT,QAAS,uBACT,iBAAkB,yBAClB,iBAAkB,yBAClB,MAAO,oCACP,EACD,QAAS,CACR,SAAU,cACV,CACH,CACA,CAGAP,EAAgB,QAAU,IAAIO"}