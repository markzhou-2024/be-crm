"use strict";const e=require("../../../../common/vendor.js"),m=require("../../common/login-page.mixin.js"),n=require("../../common/password.js"),c=e.tr.importObject("uni-id-co",{errorOptions:{type:"toast"}}),p={mixins:[m.mixin],data(){return{lock:!1,focusEmail:!0,focusPassword:!1,focusPassword2:!1,formData:{email:"",code:"",password:"",password2:"",captcha:""},rules:{email:{rules:[{required:!0,errorMessage:"请输入邮箱"},{format:"email",errorMessage:"邮箱格式不正确"}]},code:{rules:[{required:!0,errorMessage:"请输入邮箱验证码"},{pattern:/^.{6}$/,errorMessage:"请输入6位验证码"}]},...n.passwordMod.getPwdRules()},logo:"/static/logo.png"}},computed:{isEmail(){return/@/.test(this.formData.email)},isPwd(){return/^.{6,20}$/.test(this.formData.password)},isCode(){return/^\d{6}$/.test(this.formData.code)}},onLoad(r){r&&r.emailNumber&&(this.formData.email=r.emailNumber,r.lock&&(this.lock=r.lock,this.focusEmail=!0))},onReady(){this.formData.email&&this.$refs.shortCode.start(),this.$refs.form.setRules(this.rules)},onShow(){},methods:{submit(){this.$refs.form.validate().then(r=>{let{email:a,password:t,captcha:u,code:o}=this.formData;c.resetPwdByEmail({email:a,code:o,password:t,captcha:u}).then(i=>{e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withpwd",complete:s=>{}})}).catch(i=>{i.errCode=="uni-id-captcha-required"&&this.$refs.popup.open()}).finally(i=>{this.formData.captcha=""})}).catch(r=>{let a=r[0].key;if(a=="code")return this.$refs.shortCode.focusSmsCodeInput=!0;a=a.replace(a[0],a[0].toUpperCase()),this["focus"+a]=!0})},retrieveByPhone(){e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/retrieve/retrieve"})},backLogin(){e.index.redirectTo({url:"/uni_modules/uni-id-pages/pages/login/login-withpwd"})}}};if(!Array){const r=e.resolveComponent("uni-easyinput"),a=e.resolveComponent("uni-forms-item"),t=e.resolveComponent("uni-id-pages-email-form"),u=e.resolveComponent("uni-forms"),o=e.resolveComponent("uni-popup-captcha");(r+a+t+u+o)()}const l=()=>"../../../uni-easyinput/components/uni-easyinput/uni-easyinput.js",f=()=>"../../../uni-forms/components/uni-forms-item/uni-forms-item.js",d=()=>"../../components/uni-id-pages-email-form/uni-id-pages-email-form.js",_=()=>"../../../uni-forms/components/uni-forms/uni-forms.js",h=()=>"../../../uni-captcha/components/uni-popup-captcha/uni-popup-captcha.js";Math||(l+f+d+_+h)();function g(r,a,t,u,o,i){return{a:o.logo,b:e.o(s=>o.focusEmail=!1),c:e.o(s=>o.formData.email=s),d:e.p({focus:o.focusEmail,disabled:o.lock,inputBorder:!1,placeholder:"请输入邮箱",modelValue:o.formData.email}),e:e.p({name:"email"}),f:e.sr("shortCode","a84a9160-4,a84a9160-3"),g:e.o(s=>o.formData.code=s),h:e.p({email:o.formData.email,type:"reset-pwd-by-email",modelValue:o.formData.code}),i:e.p({name:"code"}),j:e.o(s=>o.focusPassword=!1),k:e.o(s=>o.formData.password=s),l:e.p({focus:o.focusPassword,type:"password",inputBorder:!1,placeholder:"请输入新密码",modelValue:o.formData.password}),m:e.p({name:"password"}),n:e.o(s=>o.focusPassword2=!1),o:e.o(s=>o.formData.password2=s),p:e.p({focus:o.focusPassword2,type:"password",inputBorder:!1,placeholder:"请再次输入新密码",modelValue:o.formData.password2}),q:e.p({name:"password2"}),r:e.o((...s)=>i.submit&&i.submit(...s)),s:e.o((...s)=>i.retrieveByPhone&&i.retrieveByPhone(...s)),t:e.o((...s)=>i.backLogin&&i.backLogin(...s)),v:e.sr("form","a84a9160-0"),w:e.p({value:o.formData,"err-show-type":"toast"}),x:e.sr("popup","a84a9160-9"),y:e.o(i.submit),z:e.o(s=>o.formData.captcha=s),A:e.p({scene:"reset-pwd-by-sms",modelValue:o.formData.captcha})}}const w=e._export_sfc(p,[["render",g]]);wx.createPage(w);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/uni-id-pages/pages/retrieve/retrieve-by-email.js.map
