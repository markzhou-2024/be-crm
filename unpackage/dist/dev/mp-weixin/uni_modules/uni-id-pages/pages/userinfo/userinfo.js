"use strict";const e=require("../../../../common/vendor.js"),s=require("../../common/store.js"),r=e.tr.importObject("uni-id-co"),d={computed:{userInfo(){return s.store.userInfo},realNameStatus(){return this.userInfo.realNameAuth?this.userInfo.realNameAuth.authStatus:0}},data(){return{univerifyStyle:{authButton:{title:"本机号码一键绑定"},otherLoginButton:{title:"其他号码绑定"}},hasPwd:!1,setNicknameIng:!1}},async onShow(){this.univerifyStyle.authButton.title="本机号码一键绑定",this.univerifyStyle.otherLoginButton.title="其他号码绑定"},async onLoad(i){let o=await r.getAccountInfo();this.hasPwd=o.isPasswordSet},methods:{login(){e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd",complete:i=>{}})},logout(){s.mutations.logout()},bindMobileSuccess(){s.mutations.updateUserInfo()},changePassword(){e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/userinfo/change_pwd/change_pwd",complete:i=>{}})},bindMobile(){this.$refs["bind-mobile-by-sms"].open()},univerify(){e.index.login({provider:"univerify",univerifyStyle:this.univerifyStyle,success:async i=>{r.bindMobileByUniverify(i.authResult).then(o=>{s.mutations.updateUserInfo()}).catch(o=>{e.index.__f__("log","at uni_modules/uni-id-pages/pages/userinfo/userinfo.vue:138",o)}).finally(o=>{e.index.closeAuthView()})},fail:i=>{e.index.__f__("log","at uni_modules/uni-id-pages/pages/userinfo/userinfo.vue:145",i),(i.code=="30002"||i.code=="30001")&&this.bindMobileBySmsCode()}})},bindMobileBySmsCode(){e.index.navigateTo({url:"./bind-mobile/bind-mobile"})},setNickname(i){i?(s.mutations.updateUserInfo({nickname:i}),this.setNicknameIng=!1,this.$refs.dialog.close()):this.$refs.dialog.open()},deactivate(){e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/userinfo/deactivate/deactivate"})},async bindThirdAccount(i){const o=e.tr.importObject("uni-id-co"),a={weixin:"wx_openid",alipay:"ali_openid",apple:"apple_openid",qq:"qq_openid"}[i.toLowerCase()];this.userInfo[a]?(await o["unbind"+i](),await s.mutations.updateUserInfo()):e.index.login({provider:i.toLowerCase(),onlyAuthorize:!0,success:async u=>{const t=await o["bind"+i]({code:u.code});t.errCode&&e.index.showToast({title:t.errMsg||"绑定失败",duration:3e3}),await s.mutations.updateUserInfo()},fail:async u=>{e.index.__f__("log","at uni_modules/uni-id-pages/pages/userinfo/userinfo.vue:202",u),e.index.hideLoading()}})},realNameVerify(){e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/userinfo/realname-verify/realname-verify"})}}};if(!Array){const i=e.resolveComponent("uni-id-pages-avatar"),o=e.resolveComponent("uni-list-item"),a=e.resolveComponent("uni-list"),u=e.resolveComponent("uni-popup-dialog"),t=e.resolveComponent("uni-popup"),n=e.resolveComponent("uni-id-pages-bind-mobile");(i+o+a+u+t+n)()}const c=()=>"../../components/uni-id-pages-avatar/uni-id-pages-avatar.js",p=()=>"../../../uni-list/components/uni-list-item/uni-list-item.js",_=()=>"../../../uni-list/components/uni-list/uni-list.js",m=()=>"../../../uni-popup/components/uni-popup-dialog/uni-popup-dialog.js",g=()=>"../../../uni-popup/components/uni-popup/uni-popup.js",f=()=>"../../components/uni-id-pages-bind-mobile/uni-id-pages-bind-mobile.js";Math||(c+p+_+m+g+f)();function h(i,o,a,u,t,n){return e.e({a:e.p({width:"260rpx",height:"260rpx"}),b:e.o(l=>n.setNickname("")),c:e.p({title:"昵称",rightText:n.userInfo.nickname||"未设置",link:!0}),d:e.o(n.bindMobile),e:e.p({title:"手机号",rightText:n.userInfo.mobile||"未绑定",link:!0}),f:n.userInfo.email},n.userInfo.email?{g:e.p({title:"电子邮箱",rightText:n.userInfo.email})}:{},{h:t.hasPwd},t.hasPwd?{i:e.o(n.changePassword),j:e.p({title:"修改密码",link:!0})}:{},{k:e.o(n.setNickname),l:e.p({mode:"input",value:n.userInfo.nickname,inputType:t.setNicknameIng?"nickname":"text",title:"设置昵称",placeholder:"请输入要设置的昵称"}),m:e.sr("dialog","0be2f605-6"),n:e.p({type:"dialog"}),o:e.sr("bind-mobile-by-sms","0be2f605-8"),p:e.o(n.bindMobileSuccess),q:n.userInfo._id},n.userInfo._id?{r:e.o((...l)=>n.logout&&n.logout(...l))}:{s:e.o((...l)=>n.login&&n.login(...l))})}const b=e._export_sfc(d,[["render",h],["__scopeId","data-v-0be2f605"]]);wx.createPage(b);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/uni-id-pages/pages/userinfo/userinfo.js.map
