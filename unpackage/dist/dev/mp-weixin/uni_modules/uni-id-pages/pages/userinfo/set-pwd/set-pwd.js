"use strict";const e=require("../../../../../common/vendor.js"),m=require("../../../common/password.js"),i=require("../../../common/store.js"),c=require("../../../config.js"),p=e.tr.importObject("uni-id-co",{customUI:!0}),f={name:"set-pwd.vue",data(){return{uniIdRedirectUrl:"",loginType:"",logo:"/static/logo.png",focusNewPassword:!1,focusNewPassword2:!1,allowSkip:!1,formData:{code:"",captcha:"",newPassword:"",newPassword2:""},rules:m.passwordMod.getPwdRules("newPassword","newPassword2")}},computed:{userInfo(){return i.store.userInfo}},onReady(){this.$refs.form.setRules(this.rules)},onLoad(n){var r;this.uniIdRedirectUrl=n.uniIdRedirectUrl,this.loginType=n.loginType,c.config.setPasswordAfterLogin&&((r=c.config.setPasswordAfterLogin)!=null&&r.allowSkip)&&(this.allowSkip=!0)},methods:{submit(){if(!/^\d{6}$/.test(this.formData.code))return this.$refs.smsCode.focusSmsCodeInput=!0,e.index.showToast({title:"验证码格式不正确",icon:"none"});this.$refs.form.validate().then(n=>{p.setPwd({password:this.formData.newPassword,code:this.formData.code,captcha:this.formData.captcha}).then(r=>{e.index.showModal({content:"密码设置成功",showCancel:!1,success:()=>{i.mutations.loginBack({uniIdRedirectUrl:this.uniIdRedirectUrl,loginType:this.loginType})}})}).catch(r=>{e.index.showModal({content:r.message,showCancel:!1})})}).catch(n=>{n.errCode=="uni-id-captcha-required"?this.$refs.popup.open():e.index.__f__("log","at uni_modules/uni-id-pages/pages/userinfo/set-pwd/set-pwd.vue:117",n.errMsg)}).finally(n=>{this.formData.captcha=""})},skip(){i.mutations.loginBack({uniIdRedirectUrl:this.uniIdRedirectUrl})}}};if(!Array){const n=e.resolveComponent("uni-easyinput"),r=e.resolveComponent("uni-forms-item"),a=e.resolveComponent("uni-id-pages-sms-form"),u=e.resolveComponent("uni-forms"),s=e.resolveComponent("uni-popup-captcha");(n+r+a+u+s)()}const d=()=>"../../../../uni-easyinput/components/uni-easyinput/uni-easyinput.js",l=()=>"../../../../uni-forms/components/uni-forms-item/uni-forms-item.js",_=()=>"../../../components/uni-id-pages-sms-form/uni-id-pages-sms-form.js",w=()=>"../../../../uni-forms/components/uni-forms/uni-forms.js",h=()=>"../../../../uni-captcha/components/uni-popup-captcha/uni-popup-captcha.js";Math||(d+l+_+w+h)();function g(n,r,a,u,s,t){return e.e({a:s.logo,b:e.o(o=>s.focusNewPassword=!1),c:e.o(o=>s.formData.newPassword=o),d:e.p({focus:s.focusNewPassword,type:"password",inputBorder:!1,placeholder:"请输入密码",modelValue:s.formData.newPassword}),e:e.p({name:"newPassword"}),f:e.o(o=>s.focusNewPassword2=!1),g:e.o(o=>s.formData.newPassword2=o),h:e.p({focus:s.focusNewPassword2,type:"password",inputBorder:!1,placeholder:"请再次输入新密码",modelValue:s.formData.newPassword2}),i:e.p({name:"newPassword2"}),j:e.sr("smsCode","e5e1f63f-5,e5e1f63f-0"),k:e.o(o=>s.formData.code=o),l:e.p({type:"set-pwd-by-sms",phone:t.userInfo.mobile,modelValue:s.formData.code}),m:e.o((...o)=>t.submit&&t.submit(...o)),n:s.allowSkip},s.allowSkip?{o:e.o((...o)=>t.skip&&t.skip(...o))}:{},{p:e.sr("form","e5e1f63f-0"),q:e.p({value:s.formData,"err-show-type":"toast"}),r:e.sr("popup","e5e1f63f-6"),s:e.o(t.submit),t:e.o(o=>s.formData.captcha=o),v:e.p({scene:"set-pwd-by-sms",modelValue:s.formData.captcha})})}const y=e._export_sfc(f,[["render",g],["__scopeId","data-v-e5e1f63f"]]);wx.createPage(y);
//# sourceMappingURL=../../../../../../.sourcemap/mp-weixin/uni_modules/uni-id-pages/pages/userinfo/set-pwd/set-pwd.js.map
