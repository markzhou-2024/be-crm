"use strict";const e=require("../../../../common/vendor.js");function r(t,s){let n;return s=s||500,function(){let a=this,i=arguments;n&&clearTimeout(n);let u=!n;n=setTimeout(()=>{n=null},s),u&&t.apply(a,i)}}const c={name:"uni-sms-form",model:{prop:"modelValue",event:"update:modelValue"},props:{event:["update:modelValue"],count:{type:[String,Number],default:60},phone:{type:[String,Number],default:""},type:{type:String,default(){return"login"}},focusCaptchaInput:{type:Boolean,default(){return!1}}},data(){return{captcha:"",reverseNumber:0,reverseTimer:null,modelValue:"",focusSmsCodeInput:!1}},watch:{captcha(t,s){t.length==4&&s.length!=4&&this.start()},modelValue(t){this.$emit("input",t),this.$emit("update:modelValue",t)}},computed:{innerText(){return this.reverseNumber==0?"获取短信验证码":"重新发送("+this.reverseNumber+"s)"}},created(){this.initClick()},methods:{getImageCaptcha(t){this.$refs.captcha.getImageCaptcha(t)},initClick(){this.start=r(()=>{this.reverseNumber==0&&this.sendMsg()})},sendMsg(){if(this.captcha.length!=4)return this.$refs.captcha.focusCaptchaInput=!0,e.index.showToast({title:"请先输入图形验证码",icon:"none",duration:3e3});if(!/^1\d{10}$/.test(this.phone))return e.index.showToast({title:"手机号格式错误",icon:"none",duration:3e3});const s=e.tr.importObject("uni-id-co",{customUI:!0});e.index.__f__("log","at uni_modules/uni-id-pages/components/uni-id-pages-sms-form/uni-id-pages-sms-form.vue:139","sendSmsCode",{mobile:this.phone,scene:this.type,captcha:this.captcha}),s.sendSmsCode({mobile:this.phone,scene:this.type,captcha:this.captcha}).then(n=>{e.index.showToast({title:"短信验证码发送成功",icon:"none",duration:3e3}),this.reverseNumber=Number(this.count),this.getCode()}).catch(n=>{n.code=="uni-id-invalid-sms-template-id"?(this.modelValue="123456",e.index.showToast({title:"已启动测试模式,详情【控制台信息】",icon:"none",duration:3e3}),e.index.__f__("warn","at uni_modules/uni-id-pages/components/uni-id-pages-sms-form/uni-id-pages-sms-form.vue:164",n.message)):(this.getImageCaptcha(),this.captcha="",e.index.showToast({title:n.message,icon:"none",duration:3e3}))})},getCode(){if(this.reverseNumber==0){clearTimeout(this.reverseTimer),this.reverseTimer=null;return}this.reverseNumber--,this.reverseTimer=setTimeout(()=>{this.getCode()},1e3)}}};if(!Array){const t=e.resolveComponent("uni-captcha"),s=e.resolveComponent("uni-easyinput");(t+s)()}const p=()=>"../../../uni-captcha/components/uni-captcha/uni-captcha.js",m=()=>"../../../uni-easyinput/components/uni-easyinput/uni-easyinput.js";Math||(p+m)();function h(t,s,n,a,i,u){return{a:e.sr("captcha","4b649130-0"),b:e.o(o=>i.captcha=o),c:e.p({focus:n.focusCaptchaInput,scene:"send-sms-code",modelValue:i.captcha}),d:e.o(o=>i.focusSmsCodeInput=!1),e:e.o(o=>i.modelValue=o),f:e.p({focus:i.focusSmsCodeInput,type:"number",inputBorder:!1,maxlength:"6",clearable:!1,placeholder:"请输入短信验证码",modelValue:i.modelValue}),g:e.t(u.innerText),h:e.n(i.reverseNumber==0?"inner-text-active":""),i:e.o((...o)=>t.start&&t.start(...o))}}const l=e._export_sfc(c,[["render",h],["__scopeId","data-v-4b649130"]]);wx.createComponent(l);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/uni-id-pages/components/uni-id-pages-sms-form/uni-id-pages-sms-form.js.map
