"use strict";const e=require("../../../../common/vendor.js");function r(t,n){let i;return n=n||500,function(){let u=this,a=arguments;i&&clearTimeout(i);let o=!i;i=setTimeout(()=>{i=null},n),o&&t.apply(u,a)}}const c={name:"uni-email-code-form",model:{prop:"modelValue",event:"update:modelValue"},props:{event:["update:modelValue"],count:{type:[String,Number],default:60},email:{type:[String],default:""},type:{type:String,default(){return"register"}},focusCaptchaInput:{type:Boolean,default(){return!1}}},data(){return{captcha:"",reverseNumber:0,reverseTimer:null,modelValue:"",focusEmailCodeInput:!1}},watch:{captcha(t,n){t.length==4&&n.length!=4&&this.start()},modelValue(t){this.$emit("input",t),this.$emit("update:modelValue",t)}},computed:{innerText(){return this.reverseNumber==0?"获取邮箱验证码":"重新发送("+this.reverseNumber+"s)"}},created(){this.initClick()},methods:{getImageCaptcha(t){this.$refs.captcha.getImageCaptcha(t)},initClick(){this.start=r(()=>{this.reverseNumber==0&&this.sendMsg()})},sendMsg(){if(this.captcha.length!=4)return this.$refs.captcha.focusCaptchaInput=!0,e.index.showToast({title:"请先输入图形验证码",icon:"none",duration:3e3});if(!this.email)return e.index.showToast({title:"请输入邮箱",icon:"none",duration:3e3});if(!/@/.test(this.email))return e.index.showToast({title:"邮箱格式错误",icon:"none",duration:3e3});const n=e.tr.importObject("uni-id-co",{customUI:!0});e.index.__f__("log","at uni_modules/uni-id-pages/components/uni-id-pages-email-form/uni-id-pages-email-form.vue:144","sendEmailCode",{email:this.email,scene:this.type,captcha:this.captcha}),n.sendEmailCode({email:this.email,scene:this.type,captcha:this.captcha}).then(i=>{e.index.showToast({title:"邮箱验证码发送成功",icon:"none",duration:3e3}),this.reverseNumber=Number(this.count),this.getCode()}).catch(i=>{i.code=="uni-id-invalid-mail-template"?(this.modelValue="123456",e.index.showToast({title:"已启动测试模式,详情【控制台信息】",icon:"none",duration:3e3}),e.index.__f__("warn","at uni_modules/uni-id-pages/components/uni-id-pages-email-form/uni-id-pages-email-form.vue:169",i.message)):(this.getImageCaptcha(),this.captcha="",e.index.showToast({title:i.message,icon:"none",duration:3e3}))})},getCode(){if(this.reverseNumber==0){clearTimeout(this.reverseTimer),this.reverseTimer=null;return}this.reverseNumber--,this.reverseTimer=setTimeout(()=>{this.getCode()},1e3)}}};if(!Array){const t=e.resolveComponent("uni-captcha"),n=e.resolveComponent("uni-easyinput");(t+n)()}const l=()=>"../../../uni-captcha/components/uni-captcha/uni-captcha.js",m=()=>"../../../uni-easyinput/components/uni-easyinput/uni-easyinput.js";Math||(l+m)();function p(t,n,i,u,a,o){return{a:e.sr("captcha","bcd6b47b-0"),b:e.o(s=>a.captcha=s),c:e.p({focus:i.focusCaptchaInput,scene:"send-email-code",modelValue:a.captcha}),d:e.o(s=>a.focusEmailCodeInput=!1),e:e.o(s=>a.modelValue=s),f:e.p({focus:a.focusEmailCodeInput,type:"number",inputBorder:!1,maxlength:"6",placeholder:"请输入邮箱验证码",modelValue:a.modelValue}),g:e.t(o.innerText),h:e.n(a.reverseNumber==0?"inner-text-active":""),i:e.o((...s)=>t.start&&t.start(...s))}}const h=e._export_sfc(c,[["render",p],["__scopeId","data-v-bcd6b47b"]]);wx.createComponent(h);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/uni-id-pages/components/uni-id-pages-email-form/uni-id-pages-email-form.js.map
